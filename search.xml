<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[循环语句]]></title>
      <url>/2018/01/09/%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/</url>
      <content type="html"><![CDATA[<p>######循环控制语句—continue、break；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">continue:</span><br><span class="line">循环控制语句continue 依据条件跳过继续执行循环， ---continue 2---表示跳转到当前循环往外第二层循环；</span><br><span class="line">用于循环体中continue【N】;提前结束N层的本轮循环，而直接进入下一轮判断；最内层为第一层</span><br><span class="line">break:</span><br><span class="line">循环控制语句break 终端，退出</span><br><span class="line">用于循环体中</span><br><span class="line">---break【N】;提前结束第N层循环，最内层为第一层</span><br><span class="line">可以退出死循环；</span><br><span class="line">#while true;do [ $i -eq 5 ] &amp;&amp; break ;echo i=$i;sleep 0.3;let i++; done</span><br></pre></td></tr></table></figure></p>
<p>######if语句；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">1、单分支</span><br><span class="line">  if 判断条件；then</span><br><span class="line">        条件为真的分支代码</span><br><span class="line">  fi</span><br><span class="line"># if cmd1； then cmd2;fi;cmd3</span><br><span class="line">####################################################</span><br><span class="line">cmd1执行成功，执行cmd2,接着执行cmd3</span><br><span class="line"></span><br><span class="line">cmd1执行不成功，则不执行cmd2,跳过cmd2直接执行cmd3</span><br><span class="line"></span><br><span class="line">####################################################</span><br><span class="line"></span><br><span class="line">2、双分支</span><br><span class="line"></span><br><span class="line">  if 判断条件：then</span><br><span class="line">        条件为真的分支代码</span><br><span class="line">  else</span><br><span class="line">        条件为假的分支代码</span><br><span class="line">  fi</span><br><span class="line">3、多分支</span><br><span class="line">  if   判断条件1；then</span><br><span class="line">       条件为真的分之代码</span><br><span class="line">  elif 判断条件2；then</span><br><span class="line">       条件为真的分支代码</span><br><span class="line">  elif 判断条件3：then</span><br><span class="line">       条件为真的分支代码</span><br><span class="line">  else</span><br><span class="line">       以上条件都为假的分支代码</span><br><span class="line">  fi</span><br><span class="line">####################################################</span><br><span class="line">#if cmd1：then cmd2;elif cmd3;then cmd4;elif cmd5;then cmd6;else cmdn;fi</span><br><span class="line"> 命令1执行成功接着执行命令2、如果命令1 执行不成功，将从新再次判断命令3是否成功、、、else指前面的全都不成功将执行命令N</span><br><span class="line">####################################################</span><br><span class="line"></span><br><span class="line">read -p &quot;please input your age: &quot; age</span><br><span class="line">[[ ! &quot;$age&quot; =~ ^[[:digit:]]+$ ]] &amp;&amp; echo please input digital &amp;&amp; exit 10</span><br><span class="line">#如果非数字，提示请输入数字，并且退出；</span><br><span class="line"></span><br><span class="line">if [ &quot;$age&quot; -le 18 ]; then</span><br><span class="line">     echo &quot;you are baby&quot;</span><br><span class="line">#判断是否小于18，小于等于18则输出you are beby ,大于18则跳至下一行；</span><br><span class="line">elif [ &quot;$age&quot; -gt 18 -a &quot;$age&quot; -le 60 ];then</span><br><span class="line">     echo &quot;you need work hard&quot;</span><br><span class="line">#判断年龄，判断大于18并小于等于60，则输出you need work hard.不在此范围则跳至下一行；</span><br><span class="line">elif [ &quot;$age&quot; -le 80 ];then</span><br><span class="line">     echo &quot;you can enjoy the life&quot;</span><br><span class="line">#判断是否小于等于80，则输出you can enjoy the life,大于80则跳至下一行；</span><br><span class="line">else</span><br><span class="line">     echo &quot;you will be lucky&quot;</span><br><span class="line">#以上判断全部错误则输出you will be lucky;则表示大于80；</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">-ge 是否大于等于</span><br><span class="line"></span><br><span class="line">-le 是否小于等于</span><br><span class="line"></span><br><span class="line">-eq 是否等于</span><br><span class="line"></span><br><span class="line">-ne 是否不等于</span><br><span class="line"></span><br><span class="line">-gt 是否大于</span><br><span class="line"></span><br><span class="line">-lt 是否小于</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.          匹配任意单个字符</span><br><span class="line">[]         匹配指定范围内的任意单个字符</span><br><span class="line">[^]        匹配指定范围外的任意单个字符</span><br><span class="line">[:alnum:]  字母和 数字</span><br><span class="line">[:alpha:]  代表任何英文大小写字符，亦即 A-Z, a-z</span><br><span class="line">[:lower:]  小写字母 [:upper:]  大写字母</span><br><span class="line">[:blank:]  空白字符（空格和制表符）</span><br><span class="line">[:space:]  水平和垂直的空白字符（比[:blank:] 包含的范围广）</span><br><span class="line">[:cntrl:]  不可打印的控制字符（退格、删除、警铃...） ）</span><br><span class="line">[:digit:]  字 十进制数字 [:xdigit:] 十六进制数字</span><br><span class="line">[:graph:]  可打印的非空白字符</span><br><span class="line">[:print:]  可打印字符</span><br><span class="line">[:punct:]   标点符号</span><br><span class="line"></span><br><span class="line">查看使用率</span><br><span class="line">[root@centos6 ~]# df| sed -rn &quot;/^\/dev\/sd/p&quot;</span><br><span class="line">/dev/sda2      100660656 4621768  90918888   5% /</span><br><span class="line">/dev/sda3       50264772   53076  47651696   1% /app</span><br><span class="line">/dev/sda1         991512   40312    900000   5% /boot</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]# df| sed -rn &quot;/^\/dev\/sd/s/^.*[[:space:]]+(.*)%.*$/\1/p&quot;</span><br><span class="line">5</span><br><span class="line">1</span><br><span class="line">5</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]# df</span><br><span class="line">Filesystem     1K-blocks    Used Available Use% Mounted on</span><br><span class="line">/dev/sda2      100660656 4621768  90918888   5% /</span><br><span class="line">tmpfs             953636     228    953408   1% /dev/shm</span><br><span class="line">/dev/sda3       50264772   53076  47651696   1% /app</span><br><span class="line">/dev/sda1         991512   40312    900000   5% /boot</span><br><span class="line">/dev/sr0         3878870 3878870         0 100% /media/CentOS_6.9_Final</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]# df |sed -rn &apos;/^\/dev\/sd/s/^.*[[:space:]]+([[:digit:]]&#123;1,3&#125;)%.*$/\1/p&apos;</span><br><span class="line">5</span><br><span class="line">1</span><br><span class="line">5</span><br></pre></td></tr></table></figure></p>
<p>###case 语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">case支持glob风格的通配符：</span><br><span class="line">*：任意长度任意字符</span><br><span class="line">？：任意单个字符</span><br><span class="line">[]:指定范围内的任意单个字符</span><br><span class="line">a|b：a或b</span><br><span class="line"></span><br><span class="line">case 变量引用 in</span><br><span class="line">PAT1)</span><br><span class="line">     分支1</span><br><span class="line">      ；；</span><br><span class="line">PAT2）</span><br><span class="line">     分支2</span><br><span class="line">      ；；</span><br><span class="line">...</span><br><span class="line">*)</span><br><span class="line">     默认分支</span><br><span class="line">      ；；</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#vim case.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">read -p &quot;please input a digit &quot; n</span><br><span class="line">case $n in</span><br><span class="line">1|3|5)         ------是1、3、5其中一个就输出cmd1</span><br><span class="line">     echo cmd1</span><br><span class="line">     ;;</span><br><span class="line">2|4|6)</span><br><span class="line">     echo cmd2</span><br><span class="line">     ;;</span><br><span class="line">10|20|30)</span><br><span class="line">     echo cmd3</span><br><span class="line">     ;;</span><br><span class="line">*)            --------不符合上面条件时输出defoult cmd</span><br><span class="line">     echo defoult cmd</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#. case.sh</span><br><span class="line">please input a digit 2</span><br><span class="line">cmd2</span><br><span class="line">[root@centos6 ~]#. case.sh</span><br><span class="line">please input a digit 3</span><br><span class="line">cmd1</span><br><span class="line">[root@centos6 ~]#. case.sh</span><br><span class="line">please input a digit 4</span><br><span class="line">cmd2</span><br><span class="line">[root@centos6 ~]#. case.sh</span><br><span class="line">please input a digit 7</span><br><span class="line">defoult cmd</span><br><span class="line">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span><br><span class="line">#!/bin/bash</span><br><span class="line">read -p &quot;Do you yue? &quot; n</span><br><span class="line">case $n in</span><br><span class="line">1|3|5)</span><br><span class="line">     echo cmd1</span><br><span class="line">     ;;</span><br><span class="line">2|4|6)</span><br><span class="line">     echo cmd2</span><br><span class="line">     ;;</span><br><span class="line">[1-3]0)</span><br><span class="line">     echo cmd3</span><br><span class="line">     ;;</span><br><span class="line">*)</span><br><span class="line">     echo defoult cmd</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#vim yue.sh</span><br><span class="line">read -p &quot;yue bu yue? (yes or no) &quot; ans</span><br><span class="line">ans=`echo $ans |tr &apos;[:upper:]&apos; &apos;[:lower:]&apos;`----大小写转换赋值</span><br><span class="line"></span><br><span class="line">case $ans in</span><br><span class="line">y|ye|yes)</span><br><span class="line">     echo ok,yue</span><br><span class="line">     ;;</span><br><span class="line">n|no)</span><br><span class="line">     echo no,buyue</span><br><span class="line">     ;;</span><br><span class="line">esac</span><br><span class="line">##########################################################</span><br></pre></td></tr></table></figure></p>
<p>######for循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><span class="line">循环语句</span><br><span class="line">for、 while、until</span><br><span class="line">for 语句；</span><br><span class="line">for 变量名 in 列表；do       变量名不加$</span><br><span class="line">          循环体</span><br><span class="line">；done</span><br><span class="line"></span><br><span class="line">执行机制：</span><br><span class="line">    依次将列表中的元素赋值给“变量名”；每次赋值后即执行一次循环体；直到列表中元素耗尽，循环结束；</span><br><span class="line"></span><br><span class="line">for循环</span><br><span class="line">列表生成方式：</span><br><span class="line">  （1）直接给出列表</span><br><span class="line">  （2）整数列表</span><br><span class="line">       （a）&#123;start..end&#125;</span><br><span class="line">        (b) $(seq [start[step]] end)</span><br><span class="line">   (3) 返回列表命令</span><br><span class="line">         $(COMMAND)</span><br><span class="line">   (4) 使用glob，如：*.sh</span><br><span class="line">   (5) 变量引用-----------------------------！！！</span><br><span class="line">         $@ , $*</span><br><span class="line">[root@centos6 ~]#for n in 1 2 5 7 8 ;do echo $n ;sleep 0.5 ;done</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">5</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">[root@centos6 ~]#for n in /var/log/*.log ;do echo &quot;filename=`basename $n`&quot; ;sleep 0.5 ;done</span><br><span class="line">filename=anaconda.ifcfg.log</span><br><span class="line">filename=anaconda.log</span><br><span class="line">filename=anaconda.program.log</span><br><span class="line">filename=anaconda.storage.log</span><br><span class="line">filename=anaconda.yum.log</span><br><span class="line">filename=boot.log</span><br><span class="line">filename=dracut.log</span><br><span class="line">filename=mysqld.log</span><br><span class="line">filename=pm-powersave.log</span><br><span class="line">filename=spice-vdagent.log</span><br><span class="line">filename=wpa_supplicant.log</span><br><span class="line">filename=Xorg.0.log</span><br><span class="line">filename=Xorg.1.log</span><br><span class="line">filename=Xorg.2.log</span><br><span class="line">filename=Xorg.9.log</span><br><span class="line">filename=yum.log</span><br><span class="line">###basename 只显示基名###</span><br><span class="line">##########################################################</span><br><span class="line">for循环</span><br><span class="line">[root@centos6 ~]#sum=0;for i in &#123;1..100..5&#125;;do let sum+=i;done;echo sum=$sum</span><br><span class="line">sum=970</span><br><span class="line">相加</span><br><span class="line">bc计算</span><br><span class="line">[root@centos6 ~]#echo &#123;1..100..5&#125;</span><br><span class="line">1 6 11 16 21 26 31 36 41 46 51 56 61 66 71 76 81 86 91 96</span><br><span class="line">[root@centos6 ~]#echo &#123;1..100..5&#125;|tr &quot; &quot; &quot;+&quot;</span><br><span class="line">1+6+11+16+21+26+31+36+41+46+51+56+61+66+71+76+81+86+91+96</span><br><span class="line">[root@centos6 ~]#echo &#123;1..100..5&#125;|tr &quot; &quot; &quot;+&quot;|bc</span><br><span class="line">970</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">![for特殊用法.png](http://upload-images.jianshu.io/upload_images/6132998-b4eb7e187eb56eaa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line">##########################################################</span><br><span class="line"></span><br><span class="line">ping -[options]</span><br><span class="line"></span><br><span class="line">- w的最后期限</span><br><span class="line">在ping退出之前，指定一个超时，</span><br><span class="line">发送或接收的数据包少了。在</span><br><span class="line">这种情况下，ping在发送数据包后不会停止，</span><br><span class="line">它会等待最后期限到期，或者直到计数探针</span><br><span class="line">对网络中的错误通知进行应答或发送。</span><br><span class="line">-W超时</span><br><span class="line">在几秒钟内等待响应。的选项</span><br><span class="line">只影响任何反应的超时时间，其他的——</span><br><span class="line">聪明的ping等待着两个rtt。</span><br><span class="line"></span><br><span class="line">root@centos6 ~]#arp  查看MAC地址</span><br><span class="line">Address                  HWtype  HWaddress           Flags Mask            Iface</span><br><span class="line">172.17.252.218                   (incomplete)                              eth1</span><br><span class="line">172.17.252.243                   (incomplete)                              eth1</span><br><span class="line">192.168.239.1            ether   00:50:56:c0:00:01   C                     eth0</span><br><span class="line">172.17.252.185                   (incomplete)                              eth1</span><br><span class="line">172.17.252.28                    (incomplete)                              eth1</span><br><span class="line">172.17.252.194                   (incomplete)                              eth1</span><br><span class="line">172.17.252.15                    (incomplete)                              eth1</span><br><span class="line"></span><br><span class="line">for语句特殊用法</span><br><span class="line">for ((cmd1;cmd2;cmd3))</span><br><span class="line">do</span><br><span class="line">cmd4</span><br><span class="line">done</span><br><span class="line">[root@centos7 ~]#sum=0;for i in &#123;1..100..2&#125;;do let sum+=i;done;echo sum=$sum</span><br><span class="line">sum=2500</span><br><span class="line">[root@centos7 ~]#for((sum=0,i=1;i&lt;=100;i+=2));do let sum+=i;done;echo sum=$sum</span><br><span class="line">sum=2500</span><br><span class="line">[root@centos7 ~]#sum=0;i=1;while [ $i -le 100 ];do let sum+=i;let i+=2; done;echo sum=$sum</span><br><span class="line">sum=2500</span><br><span class="line">#################################################</span><br><span class="line">nmap扫描端口    arp查看MAC地址</span><br><span class="line">扫描端口；</span><br><span class="line">[root@centos6 ~]#nmap -v -A 172.17.252.8</span><br><span class="line"></span><br><span class="line">Starting Nmap 5.51 ( http://nmap.org ) at 2017-06-13 09:59 CST</span><br><span class="line">NSE: Loaded 57 scripts for scanning.</span><br><span class="line">Initiating ARP Ping Scan at 09:59</span><br><span class="line">Scanning 172.17.252.8 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 09:59, 0.02s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 09:59</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 09:59, 6.61s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 09:59</span><br><span class="line">Scanning 172.17.252.8 [1000 ports]</span><br><span class="line">Discovered open port 22/tcp on 172.17.252.8</span><br><span class="line">Completed SYN Stealth Scan at 09:59, 5.09s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 09:59</span><br><span class="line">Scanning 1 service on 172.17.252.8</span><br><span class="line">Completed Service scan at 09:59, 0.06s elapsed (1 service on 1 host)</span><br><span class="line">Initiating OS detection (try #1) against 172.17.252.8</span><br><span class="line">Retrying OS detection (try #2) against 172.17.252.8</span><br><span class="line">NSE: Script scanning 172.17.252.8.</span><br><span class="line">Initiating NSE at 09:59</span><br><span class="line">Completed NSE at 09:59, 0.09s elapsed</span><br><span class="line">Nmap scan report for 172.17.252.8</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 999 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: 1024 e3:96:d3:12:5d:13:49:3c:d2:16:c9:d8:40:14:fa:8a (DSA)</span><br><span class="line">|_2048 f5:ea:a1:0c:c4:e7:b2:08:a7:7e:38:eb:c7:96:5c:a5 (RSA)</span><br><span class="line">MAC Address: 00:0C:29:F7:2B:AD (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: specialized|WAP|general purpose</span><br><span class="line">Running (JUST GUESSING): Crestron 2-Series (90%), Netgear embedded (90%), Linux 2.6.X (86%)</span><br><span class="line">Aggressive OS guesses: Crestron XPanel control system (90%), Netgear DG834G WAP (90%), Linux 2.6.24 - 2.6.35 (86%), Linux 2.6.22 (85%), Linux 2.6.23 - 2.6.33 (85%), Linux 2.6.28 (Gentoo) (85%), Linux 2.6.31 - 2.6.34 (85%), Linux 2.6.9 - 2.6.27 (85%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 0.124 days (since Tue Jun 13 07:00:56 2017)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty=262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   1.29 ms 172.17.252.8</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/share/nmap</span><br><span class="line">OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 16.26 seconds</span><br><span class="line">           Raw packets sent: 2059 (94.192KB) | Rcvd: 36 (3.228KB)</span><br><span class="line"></span><br><span class="line">查看IP地址频通情况；</span><br><span class="line">[root@centos7 bin]#cat IP2.sh</span><br><span class="line">#！/bin/bash</span><br><span class="line">up=0</span><br><span class="line">down=0</span><br><span class="line">net=172.17.252</span><br><span class="line">for i in &#123;1..100&#125;</span><br><span class="line">     do</span><br><span class="line">     ping -c1 -W1 $net.$i &amp;&gt; /dev/null &amp;&amp; &#123; echo $net.$i is up;let ++up ; &#125; || &#123; echo $net.$i is down;let ++down ; &#125;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">echo the up host is $up</span><br><span class="line">echo the host is $down</span><br><span class="line"></span><br><span class="line">[root@centos7 bin]#ps -ax |grep IP2.sh</span><br><span class="line"> 11618 pts/2    S+     0:00 bash IP2.sh</span><br><span class="line"> 11700 pts/1    S+     0:00 grep --color=auto IP2.sh</span><br><span class="line"></span><br><span class="line">##############################################</span><br><span class="line">打印星；不换行</span><br><span class="line">echo -e  \c</span><br><span class="line"></span><br><span class="line">echo -n</span><br><span class="line">两种不换行</span><br><span class="line">##############################################</span><br><span class="line">[root@centos6 ~]#cat xing.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">x=16</span><br><span class="line">y=8</span><br><span class="line">for i in `seq $y`</span><br><span class="line">do</span><br><span class="line">       for j in `seq $x`</span><br><span class="line">       do</span><br><span class="line">            echo -e &apos;*\c&apos;</span><br><span class="line">       done</span><br><span class="line">       echo</span><br><span class="line">done</span><br><span class="line">[root@centos6 ~]#vim 9*9.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">for i in `seq 9` ;do----i单一调出seq9列出的数字</span><br><span class="line">       for j in `seq $i` ;do ---j单一调出seq $i列出的数字。</span><br><span class="line">       let x=j*i  乘法运算</span><br><span class="line">       echo -en &quot;$j*$i=$x\t&quot;</span><br><span class="line">    done</span><br><span class="line">       echo</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">---\t为 TAB键为对齐---</span><br><span class="line">echo -e为激活转义 -n 为不换行</span><br><span class="line">[root@centos6 ~]#. 9*9.sh</span><br><span class="line">1=1</span><br><span class="line">2=2     2=4</span><br><span class="line">3=3     3=6     3=9</span><br><span class="line">4=4     4=8     4=12    4=16</span><br><span class="line">5=5     5=10    5=15    5=20    5=25</span><br><span class="line">6=6     6=12    6=18    6=24    6=30    6=36</span><br><span class="line">7=7     7=14    7=21    7=28    7=35    7=42    7=49</span><br><span class="line">8=8     8=16    8=24    8=32    8=40    8=48    8=56    8=64</span><br><span class="line">9=9     9=18    9=27    9=36    9=45    9=54    9=63    9=72    9=81</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#vim 9*9.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">for i in `seq 9` ;do</span><br><span class="line">       for j in `seq $i` ;do</span><br><span class="line">       let x=j*i</span><br><span class="line">       echo -en &quot;$&#123;j&#125;x$&#123;i&#125;=$&#123;x&#125;\t&quot;</span><br><span class="line">    done</span><br><span class="line">       echo</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#. 9*9.sh</span><br><span class="line">1x1=1</span><br><span class="line">1x2=2   2x2=4</span><br><span class="line">1x3=3   2x3=6   3x3=9</span><br><span class="line">1x4=4   2x4=8   3x4=12  4x4=16</span><br><span class="line">1x5=5   2x5=10  3x5=15  4x5=20  5x5=25</span><br><span class="line">1x6=6   2x6=12  3x6=18  4x6=24  5x6=30  6x6=36</span><br><span class="line">1x7=7   2x7=14  3x7=21  4x7=28  5x7=35  6x7=42  7x7=49</span><br><span class="line">1x8=8   2x8=16  3x8=24  4x8=32  5x8=40  6x8=48  7x8=56  8x8=64</span><br><span class="line">1x9=9   2x9=18  3x9=27  4x9=36  5x9=45  6x9=54  7x9=63  8x9=72  9x9=81</span><br><span class="line">[root@centos6 ~]#vim 9*9.2.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">for i in `seq 9` ;do</span><br><span class="line">      for j in `seq $i`;do</span><br><span class="line"></span><br><span class="line">            echo -ne &quot;$i*$j=$[j*i]\t&quot;</span><br><span class="line"></span><br><span class="line">          done</span><br><span class="line">      echo</span><br><span class="line">done</span><br><span class="line">~</span><br><span class="line">##############################################</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#n=-20;[[ $n =~ ^-?[[:digit:]]+$ ]]&amp;&amp; echo true</span><br><span class="line">true</span><br><span class="line">[root@centos6 ~]#ans=Y;ans=`echo $ans |tr &apos;A-Z&apos; &apos;a-z&apos;`; [[ $ans =~ ^yes|y$ ]]&amp;&amp;echo yes</span><br><span class="line">yes</span><br><span class="line"></span><br><span class="line">双中括号支持正则表达式</span><br><span class="line">##############################################</span><br><span class="line">三角形</span><br><span class="line">read -p &quot;请输入行数：&quot; x</span><br><span class="line">for i in `seq` $x ; do</span><br><span class="line">      let a=2*i-1</span><br><span class="line">      let b=x-i</span><br><span class="line">      for k in seq $b ; do</span><br><span class="line">      echo -n &quot; &quot;</span><br><span class="line">      done</span><br><span class="line">      for z in seq $a ; do</span><br><span class="line">      echo -n &quot;*&quot;</span><br><span class="line">      done</span><br><span class="line">      echo</span><br><span class="line">done</span><br><span class="line">##############################################</span><br><span class="line">2*第几行的编号=第几行的星的个数</span><br><span class="line"></span><br><span class="line">总行数-当前行的编号=等于当前行的空格数</span><br><span class="line">#############################################</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#vim sanjiao.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">read -p &quot;请输入数字：&quot; x</span><br><span class="line">[[ ！$x =~ [:digit:] ]] &amp;&amp;&#123;  echo &apos;请输入数字&apos;; exit ; &#125; || echo &apos;等边三角形&apos;</span><br><span class="line">  双中括号，是否包含，          看成整体，需加大括号；</span><br><span class="line"></span><br><span class="line">for i in `seq $x` ; do</span><br><span class="line">     let a=x-i</span><br><span class="line">     let b=2*i-1</span><br><span class="line">    for z in `seq $a`; do</span><br><span class="line">           echo -n &quot; &quot;</span><br><span class="line">              done</span><br><span class="line">    for y in `seq $b`; do</span><br><span class="line">           echo -n &quot;*&quot;</span><br><span class="line">               done</span><br><span class="line">        echo</span><br><span class="line">  done</span><br><span class="line">#################################################</span><br></pre></td></tr></table></figure></p>
<p>######while循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">while CONDITION ; do</span><br><span class="line">       循环体</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">CONDITION: 循环控制条件；进入循环之前，先做一次判断；每一次循环之后会再次做判断；条件为“true”,则执行一次循环；直到条件测试状态为“false”终止循环</span><br><span class="line">因此：CONDITION一般应该有循环控制变量；而此变量的值 会在循环体不断地陪修正</span><br><span class="line">进入条件：CONDITION为true</span><br><span class="line">退出条件：CONDITION为false</span><br><span class="line">特殊用法</span><br><span class="line">while 循环特殊用法</span><br><span class="line">while read line ; do</span><br><span class="line">     循环体</span><br><span class="line">done &lt; /PATH/FROM/SOMEFILE</span><br><span class="line">依次读取文件中的每一行，并将行赋值给变量line</span><br><span class="line">#################################################</span><br><span class="line">选取随机密码；</span><br><span class="line">bDN9ajsv</span><br><span class="line">[root@centos6 ~]#cat /dev/urandom |tr -dc &apos;a-zA-Z0-9&apos;|head -c 8</span><br><span class="line">#####################################</span><br><span class="line">tr -dc -----删除并替换</span><br><span class="line">#####################################</span><br><span class="line">[root@centos6 ~]#vim while.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">i=1</span><br><span class="line">while [ &quot;$i&quot; -le 10 ];do</span><br><span class="line">      useradd user$i</span><br><span class="line">      echo &quot;user$i is created&quot;</span><br><span class="line">      password=`cat /dev/urandom |tr -dc &apos;a-zA-Z0-9&apos;|head -c 8`</span><br><span class="line">      echo $password |passwd --stdin user$i &amp;&gt; /dev/null</span><br><span class="line">      let i++ ;</span><br><span class="line">done</span><br><span class="line">##########################################################</span><br><span class="line">[root@centos6 ~]#chage -d0 user1</span><br><span class="line">重设口令</span><br><span class="line">[root@centos6 ~]#passwd -e user2</span><br><span class="line">重设口令</span><br><span class="line">##########################################################</span><br></pre></td></tr></table></figure></p>
<p>######until<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#################################################</span><br><span class="line">until CONDITION;do   倒序  until false; do</span><br><span class="line">      循环体</span><br><span class="line">                              循环体</span><br><span class="line">done                         Done</span><br><span class="line"></span><br><span class="line">#################################################</span><br></pre></td></tr></table></figure></p>
<p>######continue ,break<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">循环控制语句continue ,break</span><br><span class="line">用于循环中</span><br><span class="line">continue [N];提前结束第N层的本轮循环，而直接进入下一轮判断；最内层为第一层</span><br><span class="line"></span><br><span class="line">N --- 表示最外层循环；</span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">for i in &#123;1..10&#125;</span><br><span class="line">do</span><br><span class="line">  [ $i -eq 5 ] &amp;&amp; continue---结束本次循环</span><br><span class="line">  echo i=$1</span><br><span class="line">  sleep 0.5</span><br><span class="line">done</span><br><span class="line">echo test is finished</span><br><span class="line">#!/bin/bash</span><br><span class="line">for i in &#123;1..10&#125;</span><br><span class="line">do</span><br><span class="line">  [ $i -eq 5 ] &amp;&amp; break --- 结束整个循环</span><br><span class="line">  echo i=$1</span><br><span class="line">  sleep 0.5</span><br><span class="line">done</span><br><span class="line">echo test is finished</span><br><span class="line"></span><br><span class="line">#################################################</span><br></pre></td></tr></table></figure></p>
<p>######循环控制shift命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shift [N]</span><br><span class="line">用于将参量列表list 左移指定次数，缺省为左移一次。</span><br><span class="line">参数列表 list 一旦被移动，最左端的那个参数就从列表中删除。while 循环遍历位置参量列表时，常用到shift</span><br><span class="line">#################################################</span><br></pre></td></tr></table></figure></p>
<p>######trap信号捕捉；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/bash</span><br><span class="line">trap &apos;echo int&apos; int</span><br><span class="line">trap -p</span><br><span class="line">for i in &#123;1..10&#125;;</span><br><span class="line">do</span><br><span class="line">    echo i=$i</span><br><span class="line">    sleep 0.3</span><br><span class="line">done</span><br><span class="line">trap &apos;&apos; int</span><br><span class="line">trap -p</span><br><span class="line">for i in &#123;11..20&#125;</span><br><span class="line">do</span><br><span class="line">  echo i=$i</span><br><span class="line">  sleep 0.3</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">trap &apos;-&apos; int   ---- 恢复信号，不再捕捉</span><br><span class="line">trap -p</span><br><span class="line">for i in &#123;21..30&#125;</span><br><span class="line">do</span><br><span class="line">  echo i=$i</span><br><span class="line">  sleep 0.3</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">脚本；</span><br><span class="line">#!/bin/bash</span><br><span class="line">date1=&quot;Monday&quot;</span><br><span class="line">date2=&quot;Tuesday&quot;</span><br><span class="line">date3=&quot;Wednesday&quot;</span><br><span class="line">date4=&quot;Thursday&quot;</span><br><span class="line">date5=&quot;Friday&quot;</span><br><span class="line">date6=&quot;Saturday&quot;</span><br><span class="line">date7=&quot;Sunday&quot;</span><br><span class="line">for week in `date +%A`;do      date +%A 显示星期几</span><br><span class="line"> if  [ $week==$date1 ];then    ==-----是否等于</span><br><span class="line">    echo &quot;This is $week&quot; &amp;&amp; ls -l</span><br><span class="line">elif [ $week==$date2 ];then</span><br><span class="line">    echo &quot;Thsi is $week&quot; &amp;&amp; pwd</span><br><span class="line">elif [ $week==$date3 ];then</span><br><span class="line">    echo &quot;This is $week&quot; &amp;&amp; cal</span><br><span class="line">elif [ $week==$date4 ];then</span><br><span class="line">    echo &quot;This is $week&quot; &amp;&amp; tty</span><br><span class="line">elif [ $week==$date5 ];then</span><br><span class="line">    echo &quot;this is $week&quot; &amp;&amp; id</span><br><span class="line">elif [ $week==$date6 ];then</span><br><span class="line">    echo &quot;This is $week&quot; &amp;&amp; du -sh ---显示当前目录的总和大小</span><br><span class="line">else</span><br><span class="line">    echo &quot;This is $week&quot; &amp;&amp; history -r ---将历史命令读入缓冲区中</span><br><span class="line">fi</span><br><span class="line">done</span><br><span class="line">[root@centos7 app]#cal</span><br><span class="line">      July 2017</span><br><span class="line">Su Mo Tu We Th Fr Sa</span><br><span class="line">                   1</span><br><span class="line"> 2  3  4  5  6  7  8</span><br><span class="line"> 9 10 11 12 13 14 15</span><br><span class="line">16 17 18 19 20 21 22</span><br><span class="line">23 24 25 26 27 28 29</span><br><span class="line">30 31</span><br><span class="line">[root@centos7 app]#tty</span><br><span class="line">/dev/pts/1</span><br><span class="line">[root@centos7 app]#id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line">###统计文件行数；</span><br><span class="line">[root@centos7 app]#vim wcfile.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">read -p &quot;please input a file way name or quit:&quot; file</span><br><span class="line">until [ $file == &apos;quit&apos; ]; do  条件判断； 是否等于</span><br><span class="line">      line=`cat $file | wc -l`</span><br><span class="line">      echo &quot;The file have a $line line!&quot;</span><br><span class="line">read -p &quot;pieace input a file way name:&quot; file</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<p>######select循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select varible in list</span><br><span class="line">do</span><br><span class="line"> 循环体命令</span><br><span class="line">done</span><br><span class="line">select 循环主要用于创建菜单，按数字顺序排列的才单项奖显示在标准错误上，并显示PS3提示符，等待用户输入</span><br><span class="line">用户输入菜单中的某个数字，执行相应的命令</span><br><span class="line">用户输入被保存在内置变量REPLY中</span><br><span class="line"></span><br><span class="line">select menu in huimian hulatang yangtang</span><br><span class="line">do</span><br><span class="line">  [ -z &quot;$menu&quot; -o $menu= &quot;exit&quot; ] &amp;&amp; break</span><br><span class="line">  echo  your choose is  $menu</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">#################################################</span><br></pre></td></tr></table></figure></p>
<p>######函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  函数 &#123;cmd;cmd;cmd&#125;匿名函数；没有函数名</span><br><span class="line">  #bash --version</span><br><span class="line">   查看bash 版本</span><br><span class="line"></span><br><span class="line">定义函数</span><br><span class="line">函数有两个部分组成；函数名和函数体</span><br><span class="line">语法一；function f_name&#123;</span><br><span class="line">             ...函数体...</span><br><span class="line">&#125;</span><br><span class="line">语法二：function f_name ()&#123;</span><br><span class="line">              ...函数体...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">语法三；f_name ()&#123;</span><br><span class="line">              ...函数体...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">----定义函数 大括号里要隔开一个空格输入----</span><br><span class="line"></span><br><span class="line">declare -f 显示函数</span><br><span class="line"></span><br><span class="line">declare -f func2 也可以指定某个函数</span><br><span class="line"></span><br><span class="line">declare -x 显示所有环境变量</span><br><span class="line"></span><br><span class="line">unset func2  和取消变量一样</span><br></pre></td></tr></table></figure></p>
<p>#grep ‘^.*()’ /etc/init.d/functions/</p>
]]></content>
      
        
        <tags>
            
            <tag> 循环语句 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[进程管理工具]]></title>
      <url>/2018/01/09/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<p>系统监控工具<br>    进程管理工具<br>    kill -l  信号种类<br>    httpd主页实验(kill -1)<br>    前后台切换</p>
<p>######系统监控工具<br>dstat、vmstat、iostat<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]# dstat </span><br><span class="line">You did not select any stats, using -cdngy by default.</span><br><span class="line">----total-cpu-usage---- -dsk/total- -net/total- ---paging-- ---system--</span><br><span class="line">usr sys idl wai hiq siq| read  writ| recv  send|  in   out | int   csw </span><br><span class="line">  1   1  98   1   0   0| 271k  216k|   0     0 |   0     3B| 154   184 </span><br><span class="line">  0   0 100   0   0   0|   0     0 | 240B  870B|   0     0 |  53    71 </span><br><span class="line">  1   0 100   0   0   0|   0     0 | 540B  390B|   0     0 |  54    69 </span><br><span class="line">  0   0 100   0   0   0|   0     0 | 240B  390B|   0     0 |  37    55 </span><br><span class="line">  0   0 100   0   0   0|   0     0 | 240B  390B|   0     0 |  63    78 </span><br><span class="line">  0   0 100   0   0   0|   0     0 | 780B  390B|   0     0 |  47    55 </span><br><span class="line">  0   0 100   0   0   0|   0     0 |1020B  390B|   0     0 |  66    73 </span><br><span class="line">  0   0 100   0   0   0|   0  1024B| 544B  390B|   0     0 |  54    67 </span><br><span class="line">  0   0 100   0   0   0|   0  4096B| 950B  390B|   0     0 |  74    85 </span><br><span class="line">  0   0 100   0   0   0|   0     0 | 488B  390B|   0     0 |  47    65 ^C</span><br><span class="line">[root@centos7 ~]# dstat -c</span><br><span class="line">----total-cpu-usage----</span><br><span class="line">usr sys idl wai hiq siq</span><br><span class="line">  1   1  97   1   0   0</span><br><span class="line">  0   0 100   0   0   0</span><br><span class="line">  0   0 100   0   0   0</span><br><span class="line">  0   0 100   0   0   0</span><br><span class="line">  0   0 100   0   0   0</span><br><span class="line">  0   0 100   0   0   0^C</span><br><span class="line">[root@centos7 ~]# dstat -d</span><br><span class="line">-dsk/total-</span><br><span class="line"> read  writ</span><br><span class="line"> 347k  285k</span><br><span class="line">   0    16k</span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 ^C</span><br><span class="line">[root@centos7 ~]# dstat -g</span><br><span class="line">---paging--</span><br><span class="line">  in   out </span><br><span class="line">   0     4B</span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 ^C</span><br><span class="line">[root@centos7 ~]# dstat -m</span><br><span class="line">------memory-usage-----</span><br><span class="line"> used  buff  cach  free</span><br><span class="line"> 594M 40.0k 1060M  169M</span><br><span class="line"> 595M 40.0k 1060M  169M</span><br><span class="line"> 595M 40.0k 1060M  169M</span><br><span class="line"> 595M 40.0k 1060M  169M</span><br><span class="line"> 595M 40.0k 1060M  169M^C</span><br><span class="line">[root@centos7 ~]# dstat -p</span><br><span class="line">---procs---</span><br><span class="line">run blk new</span><br><span class="line">  0   0 1.0</span><br><span class="line">  0   0   0</span><br><span class="line">  0   0   0</span><br><span class="line">  0   0   0^C</span><br><span class="line">[root@centos7 ~]# dstat -r</span><br><span class="line">--io/total-</span><br><span class="line"> read  writ</span><br><span class="line">6.27  1.19 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 </span><br><span class="line">   0     0 ^C</span><br><span class="line">[root@centos7 ~]# dstat -s</span><br><span class="line">----swap---</span><br><span class="line"> used  free</span><br><span class="line">  12k 4096M</span><br><span class="line">  12k 4096M</span><br><span class="line">  12k 4096M^C</span><br><span class="line">[root@centos7 ~]# sdtat --tcp</span><br><span class="line">bash: sdtat: command not found...</span><br><span class="line">Similar command is: &apos;dstat&apos;</span><br><span class="line">[root@centos7 ~]# dstat --tcp  </span><br><span class="line">----tcp-sockets----</span><br><span class="line">lis act syn tim clo</span><br><span class="line"> 10   2   0   0   0</span><br><span class="line"> 10   2   0   0   0</span><br><span class="line"> 10   2   0   0   0</span><br><span class="line"> 10   2   0   0   0^C</span><br><span class="line">[root@centos7 ~]# dstat udp</span><br><span class="line">You did not select any stats, using -cdngy by default.</span><br><span class="line">dstat: incorrect argument, try dstat -h for the correct syntax</span><br><span class="line">[root@centos7 ~]# dstat --udp</span><br><span class="line">--udp--</span><br><span class="line">lis act</span><br><span class="line"> 10   0</span><br><span class="line"> 10   0</span><br><span class="line"> 10   0</span><br><span class="line"> 10   0</span><br><span class="line"> 10   0^C</span><br><span class="line">[root@centos7 ~]# dstat --unix</span><br><span class="line">--unix-sockets-</span><br><span class="line">dgm str lis act</span><br><span class="line"> 41 443  66 377</span><br><span class="line"> 41 443  66 377</span><br><span class="line"> 41 443  66 377</span><br><span class="line"> 41 443  66 377^C</span><br><span class="line">[root@centos7 ~]# dstat --raw</span><br><span class="line">raw</span><br><span class="line">raw</span><br><span class="line">  0</span><br><span class="line">  0</span><br><span class="line">  0</span><br><span class="line">  0</span><br><span class="line">  0</span><br><span class="line">  0^C</span><br><span class="line">[root@centos7 ~]# dstat --socket</span><br><span class="line">------sockets------</span><br><span class="line">tot tcp udp raw frg</span><br><span class="line">  1   7   8   0   0</span><br><span class="line">  1   7   8   0   0</span><br><span class="line">  1   7   8   0   0^C</span><br><span class="line">[root@centos7 ~]# dstat --ipc</span><br><span class="line">--sysv-ipc-</span><br><span class="line">msg sem shm</span><br><span class="line">  0   0   2</span><br><span class="line">  0   0   2</span><br><span class="line">  0   0   2^C</span><br><span class="line">[root@centos7 ~]# dstat --top-cpu</span><br><span class="line">-most-expensive-</span><br><span class="line">  cpu process   </span><br><span class="line">vmtoolsd     0.1</span><br><span class="line">vmtoolsd     0.5</span><br><span class="line">vmtoolsd     0.5</span><br><span class="line">kworker/0:2  0.5</span><br><span class="line">xfsaild/sda2 0.5</span><br><span class="line">vmtoolsd     0.5</span><br><span class="line">rcu_sched    0.5</span><br><span class="line">vmtoolsd     0.5             </span><br><span class="line">vmtoolsd     0.5</span><br><span class="line">vmtoolsd     0.5</span><br><span class="line">-most-expensive-</span><br><span class="line">  cpu process                   </span><br><span class="line">ksmtuned     0.5               </span><br><span class="line">irqbalance   0.5^C</span><br><span class="line">[root@centos7 ~]# dstat --top-io</span><br><span class="line">----most-expensive----</span><br><span class="line">     i/o process      </span><br><span class="line">packagekitd 386k  174k</span><br><span class="line">sshd: root@ 146B  240B</span><br><span class="line">sshd: root@  78B  160B</span><br><span class="line">sshd: root@  78B  160B</span><br><span class="line">irqbalance 6144B    0 </span><br><span class="line">sshd: root@  71B  160B</span><br><span class="line">sshd: root@  78B  160B</span><br><span class="line">vmtoolsd   9744B    0 </span><br><span class="line">sshd: root@  71B  160B^C</span><br><span class="line">[root@centos7 ~]# dstat --top-mem</span><br><span class="line">--most-expensive-</span><br><span class="line">  memory process </span><br><span class="line">gnome-shell  145M</span><br><span class="line">gnome-shell  145M</span><br><span class="line">gnome-shell  145M</span><br><span class="line">gnome-shell  145M</span><br><span class="line">gnome-shell  145M^C</span><br><span class="line">[root@centos7 ~]# dstat --top-latency</span><br><span class="line">--highest-total--</span><br><span class="line"> latency process </span><br><span class="line">rcu_sched     817</span><br><span class="line">ksoftirqd/1  3391</span><br><span class="line">ksoftirqd/1  1090</span><br><span class="line">rcu_sched     994</span><br><span class="line">rcu_sched    1048</span><br><span class="line">kworker/1:2   123</span><br><span class="line">ksoftirqd/1   981</span><br><span class="line">xfsaild/sda2  136</span><br><span class="line">rcu_sched    1063</span><br><span class="line">ksoftirqd/1  1029^C</span><br><span class="line">[root@centos7 ~]# vmstat</span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span><br><span class="line"> 1  0     12 133548     40 1229856    0    0   166   134   88  103  1  1 97  1  0</span><br><span class="line">[root@centos7 ~]# iostat</span><br><span class="line">Linux 3.10.0-514.el7.x86_64 (centos7.bai.com)   07/01/2017      _x86_64_        (2 CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           0.25    0.78    0.72    0.98    0.00   97.27</span><br><span class="line"></span><br><span class="line">Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">scd0              0.01         0.02         0.00         66          0</span><br><span class="line">sda              10.58       332.49       265.27    1013497     808601</span><br><span class="line">sdb               0.05         0.34         0.00       1044          0</span><br><span class="line">sdc               0.05         0.34         0.00       1044          0</span><br><span class="line">sdd               0.05         0.34         0.00       1044          0</span><br></pre></td></tr></table></figure></p>
<p>进程管理工具；<br>pidof、pgerp 、ps aux 、pstree<br>kill -l、trap -l   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#pidof bc查看进程编号</span><br><span class="line">[root@centos7 ~]# bc</span><br><span class="line">bc 1.06.95</span><br><span class="line">Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc.</span><br><span class="line">This is free software with ABSOLUTELY NO WARRANTY.</span><br><span class="line">For details type `warranty&apos;. </span><br><span class="line">[root@centos7 ~]# pidof bc</span><br><span class="line">5730</span><br><span class="line">[root@centos7 ~]# kill -3 5730</span><br><span class="line">[root@centos7 ~]# bc</span><br><span class="line">bc 1.06.95</span><br><span class="line">Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc.</span><br><span class="line">This is free software with ABSOLUTELY NO WARRANTY.</span><br><span class="line">For details type `warranty&apos;. </span><br><span class="line">^\Quit (core dumped)</span><br><span class="line">[root@centos7 ~]# </span><br><span class="line">相当于quite命令退出</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">kill -l  信号种类</span><br><span class="line">[root@centos7 ~]# kill -l</span><br><span class="line"> 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP</span><br><span class="line"> 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1</span><br><span class="line">11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM</span><br><span class="line">16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP</span><br><span class="line">21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ</span><br><span class="line">26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR</span><br><span class="line">31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3</span><br><span class="line">38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8</span><br><span class="line">43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13</span><br><span class="line">48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12</span><br><span class="line">53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7</span><br><span class="line">58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2</span><br><span class="line">63) SIGRTMAX-1  64) SIGRTMAX</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]# trap -l</span><br><span class="line"> 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP</span><br><span class="line"> 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1</span><br><span class="line">11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM</span><br><span class="line">16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP</span><br><span class="line">21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ</span><br><span class="line">26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR</span><br><span class="line">31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3</span><br><span class="line">38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8</span><br><span class="line">43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13</span><br><span class="line">48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12</span><br><span class="line">53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7</span><br><span class="line">58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2</span><br><span class="line">63) SIGRTMAX-1  64) SIGRTMAX</span><br><span class="line"></span><br><span class="line">###trap -l   、 kill -l 查看信号管理种类</span><br><span class="line">1---无需关闭进程，将其重新读取配置文件</span><br><span class="line">2---终止正在运行中的进程：相当于ctrl+c</span><br><span class="line">3---相当于ctrl+\ 相当用quit命令退出</span><br><span class="line">9---强制杀死正在运行中的进程</span><br><span class="line">15---终止运行的进程，相当于kill  、可以不写 -15。打开vim用15关闭进程，不能保存文件。</span><br><span class="line">18---继续运行</span><br><span class="line">19---后台休眠</span><br><span class="line"></span><br><span class="line">pgrep命令 </span><br><span class="line">查询当前某个用户开启了那些进程</span><br><span class="line"></span><br><span class="line">pgrep -U bai发起者进程编号      </span><br><span class="line">      -aU     进程名称</span><br><span class="line">pgrep -u bai 生效者进程编号</span><br><span class="line">pgrep -au bai </span><br><span class="line">pstree 查看树状结构进程编号</span><br><span class="line">[bai@centos7 ~]$ ping 127.1</span><br><span class="line">PING 127.1 (127.0.0.1) 56(84) bytes of data.</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.113 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.048 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.050 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=4 ttl=64 time=0.046 ms</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]# pgrep -aU bai</span><br><span class="line">6026 -bash</span><br><span class="line">6070 ping 127.1</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]# pgrep -u bai </span><br><span class="line">6026</span><br><span class="line">6070</span><br><span class="line">[root@centos7 ~]# pgrep -au bai</span><br><span class="line">6026 -bash</span><br><span class="line">6070 ping 127.1</span><br><span class="line"></span><br><span class="line">kill -15</span><br><span class="line">杀父进程</span><br><span class="line">[root@centos7 ~]# pgrep -aU bai</span><br><span class="line">6026 -bash</span><br><span class="line">6259 ping 127.1</span><br><span class="line">[root@centos7 ~]# pgrep -au bai</span><br><span class="line">6026 -bash</span><br><span class="line">6259 ping 127.1</span><br><span class="line">[root@centos7 ~]# kill 6026</span><br><span class="line">[root@centos7 ~]# pgrep -au bai</span><br><span class="line">6026 -bash</span><br><span class="line">6259 ping 127.1</span><br><span class="line">[root@centos7 ~]# pgrep -aU bai</span><br><span class="line">6026 -bash</span><br><span class="line">6259 ping 127.1</span><br><span class="line">[root@centos7 ~]# </span><br><span class="line">不起作用 15命令</span><br><span class="line"></span><br><span class="line">kill -9 </span><br><span class="line">1、[root@centos7 ~]# pgrep -aU bai</span><br><span class="line">7095 -bash</span><br><span class="line">7135 vim f</span><br><span class="line">[root@centos7 ~]# kill -9 7095</span><br><span class="line">[root@centos7 ~]# pgrep -aU bai</span><br><span class="line">ping特殊</span><br><span class="line">2、[root@centos7 ~]# pgrep -au bai</span><br><span class="line">7261 -bash</span><br><span class="line">7301 ping 127.1</span><br><span class="line">[root@centos7 ~]# kill -9 7261</span><br><span class="line">[root@centos7 ~]# pgrep -au bai</span><br><span class="line">7301 ping 127.1</span><br><span class="line">再生进程</span><br><span class="line">[root@centos6 ~]#ps aux |grep ming    </span><br><span class="line">root       2616  0.0  0.0   4068   540 tty2     Ss+  02:38   0:00 /sbin/mingetty /dev/tty2</span><br><span class="line">root       2618  0.0  0.0   4068   540 tty3     Ss+  02:38   0:00 /sbin/mingetty /dev/tty3</span><br><span class="line">root       2620  0.0  0.0   4068   544 tty4     Ss+  02:38   0:00 /sbin/mingetty /dev/tty4</span><br><span class="line">root       2626  0.0  0.0   4068   544 tty5     Ss+  02:38   0:00 /sbin/mingetty /dev/tty5</span><br><span class="line">root       2640  0.0  0.0   4068   544 tty6     Ss+  02:38   0:00 /sbin/mingetty /dev/tty6</span><br><span class="line">root       4549  0.0  0.0 103336   852 pts/1    S+   07:28   0:00 grep ming</span><br><span class="line">kill 1 杀死父进程，不能在生成</span><br><span class="line">###killall bash</span><br><span class="line">[root@centos7 ~]# pidof bash</span><br><span class="line">4020 2152 648</span><br><span class="line">[root@centos7 ~]# killall bash</span><br><span class="line">可以杀死所有bash进程</span><br><span class="line">[root@centos7 ~]# killall vim</span><br><span class="line">[root@centos7 ~]# pidof vim</span><br><span class="line">4230 4229</span><br><span class="line">[root@centos7 ~]# killall -9 vim</span><br><span class="line">[root@centos7 ~]# pidof vim</span><br><span class="line"></span><br><span class="line">###pkill 支持模式 信号杀进程 与kill 类似</span><br><span class="line">杀进程终端，</span><br><span class="line">[root@centos7 ~]# w</span><br><span class="line"> 15:05:21 up 3 min,  3 users,  load average: 0.20, 0.45, 0.22</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     :0       :0               15:02   ?xdm?  16.50s  0.33s gdm-session-worker [pam/gdm-autologin]</span><br><span class="line">root     pts/0    192.168.239.1    15:03    1.00s  0.08s  0.03s w</span><br><span class="line">root     pts/2    192.168.239.1    15:04   33.00s  0.06s  0.06s -bash</span><br><span class="line">[root@centos7 ~]# who</span><br><span class="line">root     pts/1        2017-07-01 13:04 (192.168.239.1)</span><br><span class="line">root     :0           2017-07-01 13:04 (:0)</span><br><span class="line">root     pts/0        2017-07-01 14:22 (192.168.239.1)</span><br><span class="line">root     pts/2        2017-07-01 14:29 (192.168.239.1)</span><br><span class="line">[root@centos7 ~]# tty</span><br><span class="line">/dev/pts/1</span><br><span class="line">[root@centos7 ~]# pgrep -t pts/0     </span><br><span class="line">4020</span><br><span class="line">[root@centos7 ~]# tty</span><br><span class="line">/dev/pts/0</span><br><span class="line">[root@centos7 ~]# pgrep -t /dev/pts/0</span><br><span class="line">[root@centos7 ~]# pgrep -t pts/0     </span><br><span class="line">4020</span><br><span class="line">[root@centos7 ~]# pkill -t pts/0</span><br><span class="line">[root@centos7 ~]# pgrep -t pts/0</span><br><span class="line">4020</span><br><span class="line">[root@centos7 ~]# pkill -t pts/0 -9</span><br><span class="line">[root@centos7 ~]# pgrep -t pts/0</span><br></pre></td></tr></table></figure>
<p>######httpd主页实验(kill -1)；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">安装好httpd服务、links；</span><br><span class="line">#kill -1 重新读取配置文件</span><br><span class="line">###nmcli connection reload ,重新新读取配置文件</span><br><span class="line"></span><br><span class="line">修改服务配置文件；</span><br><span class="line">vim /etc/httpd/conf/httpd.conf</span><br><span class="line">修改目录后的变化</span><br><span class="line">centos7</span><br><span class="line">#cd /var/www/html 存放外部服务主页文件所在的目录</span><br><span class="line">#echo www.mage.com &gt; index.html</span><br><span class="line">创建主页</span><br><span class="line">#systemctl status httpd</span><br><span class="line">查看是否启用服务</span><br><span class="line">#systemctl start httpd</span><br><span class="line"> 启用服务</span><br><span class="line">#links 192.168.8.133</span><br><span class="line">  CENTOS6启用字符界面游览器</span><br><span class="line">#yum -y install links</span><br><span class="line">安装字符游览器</span><br><span class="line">centos7</span><br><span class="line">#iptables -vnL</span><br><span class="line">产看防火墙</span><br><span class="line">#iptables -F</span><br><span class="line">关闭防火墙</span><br><span class="line">#links 192...</span><br><span class="line">echo testpage &gt; test.html</span><br><span class="line">#links 192.168.8.133/taes.html </span><br><span class="line">更改主页位置</span><br><span class="line">mkdir /var/www/newsite</span><br><span class="line">echo  new site page &gt; /var/www/newsite/index.html</span><br><span class="line">放到新的目录</span><br><span class="line">需要在配置文件更改路径；/var/www/newsite/</span><br><span class="line">不用重启发信号可以启用，查看发到哪个进程上，重新读取配置文件</span><br><span class="line">#pstree 查看进程</span><br><span class="line">httpd 父进程；</span><br><span class="line">#ps axu </span><br><span class="line">#kill 1 (hup) 3287 </span><br><span class="line">#links 192.168.8.133</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> vim /etc/httpd/conf/httpd.conf</span><br><span class="line">#</span><br><span class="line"># This is the main Apache server configuration file.  It contains the</span><br><span class="line"># configuration directives that give the server its instructions.</span><br><span class="line"># See &lt;URL:http://httpd.apache.org/docs/2.2/&gt; for detailed information.</span><br><span class="line"># In particular, see</span><br><span class="line"># &lt;URL:http://httpd.apache.org/docs/2.2/mod/directives.html&gt;</span><br><span class="line"># for a discussion of each configuration directive.</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"># Do NOT simply read the instructions in here without understanding</span><br><span class="line"># what they do.  They&apos;re here only as hints or reminders.  If you are unsure</span><br><span class="line"># consult the online docs. You have been warned.  </span><br><span class="line">#</span><br><span class="line"># The configuration directives are grouped into three basic sections:</span><br><span class="line">#  1. Directives that control the operation of the Apache server process as a</span><br><span class="line">#     whole (the &apos;global environment&apos;).</span><br><span class="line">#  2. Directives that define the parameters of the &apos;main&apos; or &apos;default&apos; server,</span><br><span class="line">#     which responds to requests that aren&apos;t handled by a virtual host.</span><br><span class="line">#     These directives also provide default values for the settings</span><br><span class="line">#     of all virtual hosts.</span><br><span class="line">#  3. Settings for virtual hosts, which allow Web requests to be sent to</span><br><span class="line">#     different IP addresses or hostnames and have them handled by the</span><br><span class="line">#     same Apache server process.</span><br><span class="line">#</span><br><span class="line"># Configuration and logfile names: If the filenames you specify for many</span><br><span class="line"># of the server&apos;s control files begin with &quot;/&quot; (or &quot;drive:/&quot; for Win32), the</span><br><span class="line"># server will use that explicit path.  If the filenames do *not* begin</span><br><span class="line"># with &quot;/&quot;, the value of ServerRoot is prepended -- so &quot;logs/foo.log&quot;</span><br><span class="line"># with ServerRoot set to &quot;/etc/httpd&quot; will be interpreted by the</span><br><span class="line"># server as &quot;/etc/httpd/logs/foo.log&quot;.</span><br><span class="line">&quot;/etc/httpd/conf/httpd.conf&quot; 1009L, 34419C</span><br></pre></td></tr></table></figure>
<p>######前后台切换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">#ping 127.1</span><br><span class="line">前端执行敲命令不起作用</span><br><span class="line">#pidof ping </span><br><span class="line">查看进程编号</span><br><span class="line">#kill -19 +进程编号</span><br><span class="line">后台暂停</span><br><span class="line">[root@centos7 ~]# w</span><br><span class="line"> 15:20:47 up 18 min,  3 users,  load average: 0.01, 0.04, 0.11</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     :0       :0               15:02   ?xdm?  20.00s  0.34s gdm-session-worker [pam/gdm-autologin]</span><br><span class="line">root     pts/0    192.168.239.1    15:03    7.00s  0.06s  0.00s ping 127.1</span><br><span class="line">root     pts/2    192.168.239.1    15:04    7.00s  0.10s  0.04s w</span><br><span class="line">[root@centos7 ~]# </span><br><span class="line">[root@centos7 ~]# pidof ping</span><br><span class="line">3368</span><br><span class="line">[root@centos7 ~]# kill -19 3368</span><br><span class="line">[root@centos7 ~]# pidof ping   </span><br><span class="line">3380 3368</span><br><span class="line">[root@centos7 ~]# killall -19 ping</span><br><span class="line"></span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=48 ttl=64 time=0.048 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=49 ttl=64 time=0.051 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=50 ttl=64 time=0.055 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=51 ttl=64 time=0.052 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=52 ttl=64 time=0.052 ms</span><br><span class="line"></span><br><span class="line">[2]+  Stopped                 ping 127.1</span><br><span class="line">[root@centos7 ~]# ls</span><br><span class="line">anaconda-ks.cfg  Desktop    Downloads     httpd-2.4.25.tar.bz2  Music  Pictures  Templates  Videos</span><br><span class="line">bin              Documents  httpd-2.4.25  initial-setup-ks.cfg  part   Public    user.txt</span><br><span class="line">[root@centos7 ~]# pwd</span><br><span class="line">/root</span><br><span class="line">[root@centos7 ~]# who</span><br><span class="line">root     :0           2017-07-01 15:02 (:0)</span><br><span class="line">root     pts/0        2017-07-01 15:03 (192.168.239.1)</span><br><span class="line">root     pts/2        2017-07-01 15:04 (192.168.239.1)</span><br><span class="line">[root@centos7 ~]# blkid</span><br><span class="line">/dev/sda1: UUID=&quot;dfe31250-40b8-4eaf-bf35-f462946a56e4&quot; TYPE=&quot;xfs&quot; </span><br><span class="line">/dev/sda2: UUID=&quot;f86bb45c-c257-4f7c-ae3c-fa72b50f277c&quot; TYPE=&quot;xfs&quot; </span><br><span class="line">/dev/sda3: UUID=&quot;47a6bd61-66c5-4ddc-92fe-e2325e613aee&quot; TYPE=&quot;swap&quot; </span><br><span class="line">/dev/sda5: UUID=&quot;f3824e25-f0da-4699-9607-f50ec1795e2d&quot; TYPE=&quot;xfs&quot; </span><br><span class="line">/dev/sr0: UUID=&quot;2016-12-05-13-52-39-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; TYPE=&quot;iso9660&quot; PTTYPE=&quot;dos&quot; </span><br><span class="line">切换到后台停止后先前  敲过得命令执行后显示到屏幕上</span><br><span class="line">[root@centos7 ~]# ps axu</span><br><span class="line">USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root          1  0.1  0.3 193628  6732 ?        Ss   15:01   0:01 /usr/lib/systemd/systemd --switched-ro</span><br><span class="line">root          2  0.0  0.0      0     0 ?        S    15:01   0:00 [kthreadd]</span><br><span class="line">root          3  0.0  0.0      0     0 ?        S    15:01   0:00 [ksoftirqd/0]</span><br><span class="line">root          5  0.0  0.0      0     0 ?        S&lt;   15:01   0:00 [kworker/0:0H]</span><br><span class="line">root          6  0.0  0.0      0     0 ?        S    15:01   0:00 [kworker/u256:0]</span><br><span class="line">root          7  0.0  0.0      0     0 ?        S    15:01   0:00 [migration/0]</span><br><span class="line">root          8  0.0  0.0      0     0 ?        S    15:01   0:00 [rcu_bh]</span><br><span class="line">root          9  0.0  0.0      0     0 ?        R    15:01   0:00 [rcu_sched]</span><br><span class="line">root         10  0.0  0.0      0     0 ?        S    15:01   0:00 [watchdog/0]</span><br><span class="line">###查看运行程序进程状态信号</span><br><span class="line">[root@centos7 ~]# jobs</span><br><span class="line">[1]+  Stopped                 ping 127.1</span><br><span class="line">[root@centos7 ~]# kill -18 3368</span><br><span class="line">[root@centos7 ~]# 64 bytes from 127.0.0.1: icmp_seq=69 ttl=64 time=0.044 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=70 ttl=64 time=0.051 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=71 ttl=64 time=0.051 ms</span><br><span class="line">###kill -18 </span><br><span class="line">后台运行</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-9059fb95a4b32258.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="后台运行，可以输入命令，查看命令结果"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">kill -22</span><br><span class="line">[root@centos7 ~]# kill -22 3368</span><br><span class="line"></span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=739 ttl=64 time=0.059 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=740 ttl=64 time=0.052 ms</span><br><span class="line">[1]+  Stopped                 ping 127.1</span><br><span class="line">#ps axu</span><br><span class="line">root       3368  0.0  0.0 127912  1224 pts/0    T    15:20   0:00 ping 127.1</span><br><span class="line"></span><br><span class="line">fg 1 从后台调到前台，不管休眠还是运行</span><br><span class="line">bg 1 将后台休眠调到后台运行</span><br><span class="line">cmd+ &amp; 后台运行</span><br><span class="line">前台运行时不能在当前界面输入命令执行，用快捷键ctrl+z切换到后台暂停（休眠）界面再输入bg 1就可以后运行了，输入fg 1 调回前台运行。</span><br><span class="line"></span><br><span class="line">###前台执行断开网络（断开端口）命令不在执行</span><br><span class="line">###后台执行断开网络（断开端口）命令不在执行</span><br><span class="line">###开启screen会话界面可以后台运行</span><br><span class="line">#yum -y install screen</span><br><span class="line">#screen</span><br><span class="line">#ping 127.1</span><br><span class="line">[root@centos7 ~]# pstree -p</span><br><span class="line">├─sshd(993)─┬─sshd(2990)───bash(2994)───pstree(4224)</span><br><span class="line">            └─sshd(3085)───bash(3089)───screen(4176)───screen(4177)───bash(4178)───ping(4213+</span><br><span class="line">断开网络后</span><br><span class="line">[root@centos7 ~]# ps axu|grep ping</span><br><span class="line">root       4213  0.0  0.0 127912  1228 pts/1    S+   16:12   0:00 ping 127.1</span><br><span class="line">root       4438  0.0  0.0 112648   964 pts/0    S+   16:23   0:00 grep --color=auto ping</span><br><span class="line">[root@centos7 ~]# pidof ping</span><br><span class="line">4213</span><br><span class="line">[root@centos7 ~]# pstree -p</span><br><span class="line">├─screen(4177)───bash(4178)───ping(4213)</span><br><span class="line">├─smartd(599)</span><br><span class="line">├─sshd(993)─┬─sshd(2990)───bash(2994)───pstree(4381)</span><br><span class="line">                        └─sshd(4275)───bash(4279)</span><br><span class="line">根ssh服务没关系了。后台还在运行中</span><br><span class="line">恢复screen 的端口</span><br><span class="line">[root@centos7 ~]# screen -ls </span><br><span class="line">There is a screen on:</span><br><span class="line">        4177.pts-2.centos7      (Detached)</span><br><span class="line">1 Socket in /var/run/screen/S-root.</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]# screen -r</span><br><span class="line">nohup ping 127.1&amp; </span><br><span class="line">[root@centos7 ~]# nohup ping 127.1 &amp;</span><br><span class="line">[1] 4710</span><br><span class="line">[root@centos7 ~]# nohup: ignoring input and appending output to ‘nohup.out’</span><br><span class="line">[root@centos7 ~]# tail -f nohup.out</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=263 ttl=64 time=0.051 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=264 ttl=64 time=0.062 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=265 ttl=64 time=0.049 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=266 ttl=64 time=0.047 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=267 ttl=64 time=0.050 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=268 ttl=64 time=0.048 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=269 ttl=64 time=0.049 ms</span><br><span class="line">不断地输出到nohup.out 文件里</span><br><span class="line">[root@centos7 ~]# nohup ping 127.1 &amp;&gt;/dev/null &amp;</span><br><span class="line">[3] 4912</span><br><span class="line">#last 查看日志</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> 进程管理，kill </tag>
            
            <tag> dstat </tag>
            
            <tag> vmstat </tag>
            
            <tag> iostat </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[sed命令]]></title>
      <url>/2018/01/09/sed%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<p>sed  stream<br>查看 ，修改文件内容<br>grep 查看文件内容</p>
<pre><code>模式空间、保存空间（暂存空间）
</code></pre><p>sed【option】</p>
<pre><code>#cp /etc/passwd passwd
#sed -n passwd
</code></pre><p>常用选项</p>
<pre><code>-n ; 不输出模式空间内容到屏幕，即不自动打印

-e ; 多点编辑

-f ；/PATH/SCRIPT_FILE;从指定文件中读取编辑

-r ;支持使用扩展正则表达式

-i.bak ;备份文件内容并原处编辑
</code></pre><p>script; ‘地址命令 ‘</p>
<pre><code>地址加命令
不给地址，全文进行处理

#sed &apos;p&apos; passwd

打印两行，一个自动打印，加上打印

#sed -n &apos;p&apos; passwd  

打印一次

#cat /etc/passwd |sed -n &apos;p&apos;

单地址



#sed -n &apos;1p&apos;passwd

#ifconfig enc33 |sed -n &apos;2p&apos;

模式

#sed -n &apos;/^r/p&apos;passwd

#grep &apos;^r&apos; passwd

#sed -n &apos;3,6 p&apos; passwd

3到6

#sed -n &apos;3,+6p&apos; passwd

3+6行

#/pat1/,/pat2/

#sed -n &apos;/^h/,/^s/p&apos; passwd
h开头 s结尾
循环寻找

#,/pat/ 行号，

#sed -n &apos;3,/^s/p‘ passwd

sed 步进

一次增加多少


#echo {1..100}

#sep 100|sed -n &apos;1~2p&apos;

奇数

#seq 100|sed -n &apos;2~2p&apos;

偶数


#cat -n passwd |sed -n &apos;1~2!p&apos;

取反


#cat -n passwd|sed &apos;2d&apos;

#seq 100&gt;f1

#sed &apos;2d&apos; f1

#sed -i &apos;100d&apos; f1
#sed -i &apos;1~2d&apos; f1

#sed -i.bak &apos;1~2d&apos; f1
删除前备份
注意加后缀.bak
</code></pre><p>编辑命令</p>
<pre><code>d 删除模式空间匹配的行

p 显示模式空间的内容

a  在指定行后面追加文本、支持使用、\n实现多行追加

i  在行前面插入文本

c  替换行为单行或多行文本

w  保存模式匹配的行至指定的文件中

r  读取指定文件的文本至模式空间中匹配到的行后

=  为模式空间中的行打印行号

!  模式空间中匹配行取反处理

s/// 查找替换，支持使用其它分隔符，s@@@,s###
</code></pre><p>替换标记；<br>    g 行全局替换<br>    p 显示替换成功的行<br>    w /PATH/TO/SOMEFILE 将替换成功的行保存在文件中</p>
<pre><code># sed &apos;90anew line1\nnewline2\nnewline3&apos; f1
90行后加内容 换行

# sed &apos;90a\ new line\nnewline2\nnewline3&apos; f1
\ 加边界

# sed &apos;90i\ new line\nnewline2\nnewline3&apos; f1
在90的前面加

# sed &apos;90c\ new line\nnewline2\nnewline3&apos; f1
替代90行前面

# sed &apos;90w /root/f2&apos; f1
90行保存到f2 里

#  sed &apos;10r /etc/issue&apos; f1
将新的文件渎进f1

# sed &apos;10,30r /etc/issue&apos; f1
匹配到的每个行后 加新文件

#sed &apos;=&apos; passwd
加行号
#sed -n &apos;/^r/&apos;=passwd
只显示行号sed

#sed -n &apos;/.*root.*/=&apos; passwd
包含root的行号

#grep root passwd 

#grep -n root passwd


搜索替代

#vim f11
root.......
#sed &apos;s/root/ROOT/&apos; f11
替换root
#sed &apos;2-2s/root/ROOT/&apos;f11
替换 偶数行的搜索替换
#sed &apos;2-2s/root/ROOT/g&apos; f11
整行全部替换
#sed &apos;2-2s/root/ROOT/gp&apos; f11
只显示匹配到的行
#sed &apos;2-2s/root/ROOT/w f22&apos; f11
搜索完另存为f22
</code></pre><p>高级编辑命令</p>
<pre><code>h 把模式空间的内容覆盖至保持空间
H 把模式空间中的内容追加至保持空间
g 从保持空间取出数据覆盖至模式空间
G 从保持空间取出内容追加至模式空间
x 把模式空间的内容与保持空间的内容互换
n  读取匹配到的行的下一行覆盖至模式空间
N 读取匹配到的行的下一行追加至模式空间
d 删除模式空间中的行
D 删除当前模式空间开端至\n的内容 （不在传至标准输出），放弃之后的命令，但是对剩余模式空间从新执行sed

#sed &apos;s/^/#/&apos; install.log
#echo &quot;/etc/sysconfig/network&quot;
#echo &quot;/etc/sysconfig/networrk-scripts/&quot;
</code></pre><p>取出基名 目录名</p>
<pre><code>echo &quot;/etc/sysconfing/netwoerk-scripts/&quot; |sed -r &apos;s@（^/.*/）（[^/]+/?）@\2@&apos;
echo &quot;/etc/sysconfing/netwoerk-scripts/&quot; |sed -r &apos;s@（^/.*/）（[^/]+/?）@\1@&apos;
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/6132998-9680fdfa4c3edc54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20170624195228.png"></p>
<p>取出IP地址</p>
<pre><code>#ifconfig eth0|sed -n 2p
#ifconfig eth0|sed -n 2p|sed &apos;s/^.*r://&apos;|sed &apos;/ .*/d&apos;
#ifconfig eth0|sed -n 2p|sed &apos;s/^.*r://&apos;|sed&apos;s/ .*//&apos;
#ifconfig eth0|sed -n 2p |sed -e &apos;s/^.*r://&apos; -e &apos;s/.*//&apos;
</code></pre><p>模式空间 — 保持空间</p>
<pre><code>#seq 100 |sed -n &apos;n;p&apos;
#sed -n &apos;n;p&apos;

在模式空间单行进行处理，在执行命令时sed -n 
&apos;n;p&apos;时 模式空间 已进入1数字， -n 所以不打印
不输出屏幕，‘n;p’n为匹配到的下一行覆盖模式
空间的1数字并打印输出到屏幕后，模式空间转为
为空，执行下一条匹配的行3,3进入模式空间后3的
下一行进入模式空间进行覆盖并输出屏幕，并结束
一段操作，模式空间转为空，执行下一条，直到循
环结束；
</code></pre><p>hold space 保持空间</p>
<pre><code>#sed &apos;1!G;h;$!d &apos; FILE
#seq 100 |sed &apos;1!G;h；$!d &apos;
倒序输出、
非第一行时追加至模式空间，模式空间覆盖至保存空间，非结尾时删除模式空间的行

#seq 100 |sed‘N；D’
N匹配的行追加
D在上一条命令执行时进行删除操作
第100没有追加所以不执行D命令

#seq 100|sed &apos;N;d&apos;
清空
#cat passwd |sed &apos;N;D&apos;
#seq 100 |sed &apos;$!N;$!D&apos;
剩两行，非结尾时追加，非结尾时执行D命令
100追加时是结尾所以不执行D命令就不删除99行
</code></pre><p>```</p>
]]></content>
      
        
        <tags>
            
            <tag> sed </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[tar工具]]></title>
      <url>/2018/01/09/tar%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">tar：-c -f ---------(创建打包文件)</span><br><span class="line">         -v -f ----------(查看过程)</span><br><span class="line">         -t -f -----------(预览打包的文件列表)</span><br><span class="line">         -x -f ---------- (解压和解包)</span><br><span class="line">         -r -r -----------(追加)不能追加压缩文件</span><br><span class="line">压缩；</span><br><span class="line"># tar zcvf etc.tav.gz   /etc/</span><br><span class="line"># tar jcvf etc.tar.bz2  /etc/                 </span><br><span class="line"># tar Jcvf etc.tar.xz    /etc/</span><br><span class="line">压缩 ; -T, -X</span><br><span class="line"># tar Jcvf   file.tar.xz -T(file.txz)   list.txt --------将list.txt里文件目录分别压缩到file.txz里。</span><br><span class="line"># tar Jcvf   file.tar.xz -X  /etc/....                          排除/etc/目录下的指定列表，进行压缩。</span><br><span class="line">分割（大的tar文件）</span><br><span class="line"># split       -b       size     -d       file-name      prefix-name</span><br><span class="line">-b---分割的块的数量  </span><br><span class="line">size---分割的块的大小  </span><br><span class="line">-d---分割后的文件尾部排序数字  </span><br><span class="line">file-name---指定的分割文件  </span><br><span class="line">prefix-name---定义分割后的文件、前缀名称</span><br><span class="line"># split -b 1M etc.tar.bz2  etcsplit        后缀为aa、ab、ac......</span><br><span class="line"># split -d 1M etc.tar.bz2  etcsplit        后缀为00、01、02......</span><br><span class="line">合并(将分割的文件合并到一处)</span><br><span class="line"># cat etcsplit0* &gt; etc2.tar.bz2------ 要与源文件后缀一样</span><br><span class="line">解压</span><br><span class="line"># tar xvf etc.tar.xz      -C     /root/</span><br><span class="line"># tar xvf etc.tar.bz 2  -C     /root/</span><br><span class="line"># tar xvf etc.tar.gz     -C     /root/</span><br><span class="line">解压时，tar可以用tar  xvf解压三种以xz、bz2、gz后缀的压缩文件；</span><br><span class="line">- 大C为解压到指定目录时使用，解压到当前目录时不用加-大C。</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> tar </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[创建RAID设备]]></title>
      <url>/2018/01/09/%E5%88%9B%E5%BB%BARAID%E8%AE%BE%E5%A4%87/</url>
      <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">添加20、30、40、50G磁盘</span><br><span class="line">#fdisk /dev/sda</span><br><span class="line">#mdadm -C /dev/md0 -n3 -l5 -x1 /dev/sd&#123;a6,b,c1,d1&#125;</span><br><span class="line">#cat /proc/mdstat </span><br><span class="line">#which -n1 cat /proc/mdstat</span><br><span class="line">#mdadm -Ds /dev/md0</span><br><span class="line">#mdadm -Ds /dev/md0 &gt;/etc/mdadm.conf</span><br><span class="line">#mkdir /mnt/raid</span><br><span class="line">#mount /dev/md0 /mnt/raid</span><br><span class="line">#cd /mnt/raid</span><br><span class="line">#cp /etc/fstab /mnt/raid/f1</span><br><span class="line">#cp /etc/fstab /mnt/riad/f2</span><br><span class="line">#cp /var/log /mnt/riad/bigfile</span><br><span class="line">#cat f3</span><br><span class="line">#vim /etc/fstab</span><br><span class="line">#cat f1</span><br><span class="line">#lsblk</span><br><span class="line">#blkid</span><br><span class="line">#mdadm -D /dev/md0</span><br><span class="line">#mdadm /dev/md0 -f /dev/sdb1</span><br><span class="line">#mdadm /dev/md0 -r /dev/sdb1</span><br><span class="line">#mdadm /dev/md0 -a /dev/sdd1</span><br><span class="line">#mdadm -G /dev/md0 -a /dev/sdd2</span><br><span class="line">#mdadm /dev/md0 -a /dev/sdd2</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-86b9ff56e2c7600a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加完成.png"><br>]</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-07c630ef722065c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建主分区.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a3f87d9f4f39da14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文件系统类型.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-922a2af95cbf1464.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分区完成.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7ac4b449902eca73.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建raid5.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-264adc8d036d9cc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看详细信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-0301fcb624e9e0f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看进程.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4625aa0815d5a5a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建完成.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-66d7fd57721795f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建配置文件.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a56e6a2400598203.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="格式化.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-fc757d4fc076d86d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="编写挂载路径.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-47b9e81afd1b3c81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="保存挂在路径，创建挂载点.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-76f809340f64fb52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-38de0a412d6c06fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="sdc1模拟故障.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ddde17f720a937de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="自动修复状态.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8c5a33799513506d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="修复状态.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-d3e0d0e54d02fb23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="自动修复完成，sdc1无法使用.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-819e3b82a69d1615.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="移除并查看.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e3f2727078fc56a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20170622100410.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-556b66ee3f9a5c5b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="移除后，查看挂载信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-0030e7a61d4a7013.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看RAID信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e838443eab2a0523.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看性能.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6d9fd3754da3589b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加sdb.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-91e78af3f6b6e592.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="移除后的状态.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-947bae5b16d73514.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加磁盘.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-c2173dab33b8c38d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看添加状态.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-47cbda8b92e603bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加完成.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-72194fa080a30b8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加备用磁盘.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4391c667fcc39641.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加备用完成.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-916304b6217e6677.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="分区sdd2.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-452a30daa7f349e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="未能同步.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-9f72a9143d9b40ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="同步.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6cf202455f5326c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-45578825126d94b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加sdd2进度.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-82f28eb536e4cdb1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加sdd2完成.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-929abdb4aecb2466.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加备用sdd2.png"></p>
]]></content>
      
        
        <tags>
            
            <tag> RAID </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[逻辑卷及扩展逻辑卷]]></title>
      <url>/2018/01/08/%E9%80%BB%E8%BE%91%E5%8D%B7%E5%8F%8A%E6%89%A9%E5%B1%95%E9%80%BB%E8%BE%91%E5%8D%B7/</url>
      <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">准备好磁盘空间，添加/dev/sda、/dev/sde 、 /dev/sdf，将磁盘分区，/dev/sda7、/dev/sde1，留一个磁盘、/dev/sdf;</span><br></pre></td></tr></table></figure>
<h6 id="创建逻辑卷"><a href="#创建逻辑卷" class="headerlink" title="创建逻辑卷"></a>创建逻辑卷</h6><pre><code>1、创建物理卷
# pvcreate /dev/sd{a7,e1}
#pvs
#pvdisplay
2、创建卷组
#vgcreate  -s 16M vg0 /dev/sd{a7,e1}
#vgs
#vgdisplay
3、创建逻辑卷
#lvcreate -n lv0 -l  100% vg0
#lvs
#lvdisplay
#ll /dev/vg0/lv0
#ll /dev/mapper/vg0-lv0
4、配置文件
#vim /etc/fstab
5、创建文件夹
#mkdir /mnt/lv0
6、挂载逻辑卷
#mount /dev/vg0/lg0 /mnt/lv0
7、查看挂载点，是否已经挂载
#df -h
#lvdisplay
8、拷贝文件到逻辑卷上
#cp /etc/fstab /mnt/lv0
#cp /var/log/messages /mnt/lv0
9、查看文件
#cd /mnt/lv0
#cat /fstab
10、测速
dd if=/dev/zero of=/mnt/lv0/bigfile bs=1M count=1024
dd if=/mnt/lv0/bingfile of=/dev/null 
创建完成；
</code></pre><p>######扩展逻辑卷</p>
<pre><code>1、扩展物理卷
#pvcreate /dev/sdf
#pvs
#pvdisplay
2、添加卷组
#vgcreate vg0 /dev/sdf
#vgdisplay
#vgs
#df -h
3、扩展逻辑卷
#lvextent -l +1000 /dev/vg0/lv0
#lvdisplay
#df -h
4、同步文件系统
#resize2fs /dev/vg0/lv0
#df -h
#lvdisplay
5、查看文件系统及逻辑卷大小,将剩余的空间全部使用
#lvextend -r -l +100%free /dev/vg0/lv0
#df -h
#lvdisplay
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/6132998-0077cbef58b68fac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加sde,sdf磁盘分区.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1e4f1b97c35b0e13.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建物理磁盘，查看信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7cdad316b49a5df6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建卷组，查看信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-162be295c56ff373.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建逻辑卷，查看信息.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-b9446ed0ef80a6c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="路径.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-3b2ecef5df59d047.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="两个软连接.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-9c2edebc0ec1ae1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建文件系统.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a9d8925d3ff17a6a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看文件系统.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-85d0c552a3c4bae8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加配置文件.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-de46760ba447bd1c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建文件夹，挂载，查看.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ca52689288706c3d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="测速.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-610bdde12c6dec86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="扩展逻辑分区1.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6b6a477ef643da0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看详情2.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-598c442b61b2cd21.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加到逻辑卷3.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-d904016a7b7ff38d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看逻辑卷磁盘空间.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-20402eeb54b7e2f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="扩展逻辑卷查看是否同步.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-f732a4bb9c511571.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="同步文件系统.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-3081b9aade12a93f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看 逻辑卷剩余空间.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-471b192407b008fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="使用逻辑卷剩余空间，扩展完成.png"></p>
]]></content>
      
        
        <tags>
            
            <tag> 逻辑卷 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[vsftpd]]></title>
      <url>/2018/01/08/vsftpd/</url>
      <content type="html"><![CDATA[<h6 id="Centos7-3安装Vsftpd服务；"><a href="#Centos7-3安装Vsftpd服务；" class="headerlink" title="Centos7.3安装Vsftpd服务；"></a>Centos7.3安装Vsftpd服务；</h6><pre><code>1、准备好yum源路径、检查光盘是否挂载及网络状态；
2、用rpm安装vsftpd服务程序包；
3、查找启动vsftpd服务配置文件(vsftpd.service);
4、查看vftpd网络端口是否开启；
5、#systemctl start vsftpd.service启动vsftpd服务；
6、查看vftpd网络端口是否开启；
7、#systemctl enable vsftpd启动下次开启依然启动功能；
8、#systemctl is-enabled vsftpd检查上一条命令是否生效；
9、查看共享文件夹/var/ftp;
10、#iptables -vnL查看防火墙是否开启状态；
11、#systemctl stop firewalld.service关闭防火墙;
12、#iptables -vnL查看防火墙是否开启状态；
13、#systemctl disable firewalld.service下次启动虚拟机防火墙依然在关闭状态；
14、#在/var/ftp/pub/目录下建一个ftp.txt文件；
15、关闭防火前后进入ftp站点，查看是否能进入；
16、配置yum原路径，挂在盆地光盘；
17、将Centos7光盘拷贝到/var/ftp/pub/7/目录下；
18、将Centos6光盘拷贝到/var/ftp/pub/6/目录下；
19、访问ftp站点，是否成功；
20、安装Vsftpd、完成；
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/6132998-6b8b2b1cea482c07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看光盘是否挂载"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8aadd2e27d0b665c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="用rpm安装vsftpd文件包"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-bc643c93a3990de0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查找启动vsftpd服务配置文件"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a9b4347ba4bf2eaa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看vftpd网络端口启动前、启动后，是否开启"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7108769dbf011b47.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="启动vsftpd服务"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-dd77697428eebccf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看vsftpd共享目录位置"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a13dc2131a995069.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看防火墙状态，是否开启"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-883fec34f1fff53c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="停止防火墙服务及查看防火墙状态"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-da99e981dd9771fb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="禁用防火墙"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-c657c3954a7d9f6f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="在/var/ftp/pub/目录下创建一个ftp.txt文档"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-aa9f7e4476b6dd4b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="网页窗口输入ftp://192.168.239.131，查看是否能进入ftp站点 "></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-eb57acf3128bd35f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="配置yum原路径"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-262c0ef677ccdeac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="将Centos7光盘拷贝到/var/ftp/pub/7/目录下"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1448575102d90c2d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="进入ftp查看"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4826256023a0ba2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="安装完成"></p>
<h6 id="Centos6-9安装Vsftpd-跟上述类似；"><a href="#Centos6-9安装Vsftpd-跟上述类似；" class="headerlink" title="Centos6.9安装Vsftpd,跟上述类似；"></a>Centos6.9安装Vsftpd,跟上述类似；</h6><pre><code>/etc/rc.d/init.d/vsftpd 服务脚本名
#netstat -ntl查看端口;
/etc/rc.d/init.d/vsftpd启用vsftpd服务;
#service vsftpd start启用vsftpd服务;
#service iptables stop马上禁用防火墙;
#chkconfig iptables off下次依然关闭防火墙;
将/misc/cd/里的文件拷贝/var/ftp/pub/6..7;
在六七的当前目录下，cp /misc/cd/repo....  .  -r;
拷贝完后用yum repolist 命令查看包文件列表属性文件;
</code></pre>]]></content>
      
        
        <tags>
            
            <tag> 共享文件系统，vsftpd </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[rpm包管理工具，Lib64库文件修复]]></title>
      <url>/2018/01/08/rpm%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%EF%BC%8CLib64%E5%BA%93%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D/</url>
      <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、软件包基础;</span><br><span class="line">2、rpm包管理;</span><br><span class="line">3、移动lib64库文件修复过程：</span><br><span class="line">4、卸载内核修复过程</span><br></pre></td></tr></table></figure>
<ul>
<li><p>1、软件包基础</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">软件运行与编译：</span><br><span class="line">ABI:应用程序二进制接口</span><br><span class="line">API:应用程序编程接口</span><br><span class="line">静态、动态链接</span><br></pre></td></tr></table></figure>
</li>
<li><p>二进制应用程序的组成部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">二进制文件、库文件、配置文件、帮助文件</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>二进制文件<br><img src="http://upload-images.jianshu.io/upload_images/6132998-1adda484d623a0f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ls二进制文件，依赖于库文件，查看ls二进制文件which ls--,file /bin/ls"><br>库文件<br><img src="http://upload-images.jianshu.io/upload_images/6132998-8139b3425118d34a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lib64库文件"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">配置文件</span><br><span class="line">有些服务、软件较大，复杂的程序需要通过配置文件来执行实现特性、通过修改配置文件修改来影响程序的运行。(/etc/...)</span><br><span class="line"></span><br><span class="line">帮助文件</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<ul>
<li>包命名;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">源代码：name-VERSION.tar.gz|bz2|xz</span><br><span class="line">VERSION版本:major、minor、release发行</span><br><span class="line">rmp包命名方式：</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ec4369dae01b0169.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="包名称、版本号、编译者后加注、cpu架构"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">包分类和拆包</span><br><span class="line">Application-VERSION-ARCH.rpm:  主包</span><br><span class="line">Application-devel-VERSION-ARCH.rpm  开发子包（开发类放置devel）</span><br><span class="line">Application-utils-VERSION-ARHC.rpm  其它子包（应用相关放置utils）</span><br><span class="line">Application-libs-VERSION-ARHC.rpm  其它（与库相关放置libs）</span><br><span class="line">包之间：可存在依赖关系，甚至循环关系</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">解决依赖包管理工具：</span><br><span class="line">yum: rpm包管理器的前段工具</span><br><span class="line">apt-get:deb包管理器前端工具</span><br><span class="line">zypper:suse上的rpm前端管理工具</span><br><span class="line">dnf:Fedora 18+ rmp包管理器前端管理工具</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-00d3d718392aa193.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="rpm.安装包依赖性。"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看二进制程序所依赖的库文件</span><br><span class="line">ldd /path/to/binar_FILE</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-bc1e0bf0758cb571.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看ls所依赖的库文件ldd命令"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">管理及查看本机装载的库文件</span><br><span class="line">ldconfing</span><br><span class="line">/sbin/ldconfig -p:显示本机已缓存的所有可用库文件名及文件路径映射关系</span><br><span class="line">配置路径：/etc/ld.so.conf,/etc/ld.so.conf.d/*.conf</span><br><span class="line">缓存文件：/etc/ld.so.cache</span><br><span class="line">/etc/ld.so.conf.d/*.conf---配置文件，当使用第三方软件，库文件加载，指定方在一个目录里，需要单独编一个配置文件、将路径编写到配置文件。</span><br><span class="line">保存后需执行#ldconfig ，读取内容后生效。</span><br><span class="line">ldconfig -p 可以查看已经加载到内存的库文件路径，库文件信息。</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">包管理器</span><br><span class="line">debian；deb文件，dpkg包管理器</span><br><span class="line">redhat；rpm文件，rpm包管理器</span><br><span class="line"> redhat Package Manager(rpm)</span><br><span class="line">内核版本一般用偶数版本，奇数版本不稳定测试开发阶段。</span><br><span class="line">1、包文件的组成</span><br><span class="line">文件内容（文件列表、路径，元数据，一些脚本）</span><br><span class="line">RPM包内的文件</span><br><span class="line">RPM的元数据，</span><br><span class="line">安装或卸载时运行的脚本</span><br><span class="line">2、数据库（公共）：/var/lib/rpm（安装好的包的信息）</span><br><span class="line">程序包名称及版本</span><br><span class="line">依赖关系</span><br><span class="line">功能说明</span><br><span class="line">包安装后生成的文件路径及效验码信息</span><br><span class="line">程序包的来源</span><br><span class="line">管理程序包的方式</span><br><span class="line">使用包管理器：rpm</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-b96212c1d29cc0c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数据库--安装包的信息。不能随意删除，删除将不能管理包。"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-3b62e5794591bfc4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="rpm命令"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">使用前端工具：yum,dnf</span><br><span class="line">获取程序包的途径:</span><br><span class="line">1、系统发行版的光盘或官方的服务器：</span><br><span class="line">Centos镜像：</span><br><span class="line">https://www.centos.org/download/</span><br><span class="line">http://mirrors.aliyun.com</span><br><span class="line">http://mirrors.sohu.com</span><br><span class="line">http://mirrors.163.com</span><br><span class="line">2、项目官方站点</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a997cd061256b61f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="官方站点"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-fe85cbc2bab0ef19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="？"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7031911550ba2fe6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="md5 效验"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-9be26cd27b761a69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="md5 效验，输入命令。"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">3、第三方组织（软件）</span><br><span class="line">光盘里不带的软件放到epel源里（官网），企业版额外的包。</span><br><span class="line">搜索引擎 ：专门搜索安装包；</span><br><span class="line">http://pkgs.org</span><br><span class="line">http://rpmfind.net</span><br><span class="line">http://rpm.pbone.net</span><br><span class="line">https://sourceforge.net/</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">4、自己制作</span><br><span class="line">rpmbuild、FPM工具自作安装包。</span><br><span class="line"></span><br><span class="line">###2、rpm包管理</span><br><span class="line">Centos系统上使用rpm命令管理程序包：</span><br><span class="line">rpm  [option..]  file</span><br><span class="line">       -i  --install ---  安装</span><br><span class="line">      -v或vv(更详细)---  显示过程</span><br><span class="line">      -h--------------- 进度  </span><br><span class="line">      -e--------------- 卸载</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-584768a6de7ce64f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="卸载时只需写包名"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[install-options]</span><br><span class="line">--test:测试安装，但不真正执行安装，即dry run模式、模拟安装</span><br><span class="line">--nodeps:忽落依赖关系（安装时，后续依赖的包安装、否则无法运行）A依赖于B 安装顺序，先安装B后安装A。卸载时，先卸载A，后卸载B。</span><br><span class="line">--replacepkgs | replacefiles 替换、覆盖安装</span><br><span class="line">--oldpackage ：降级</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-faf8441535b9bd69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="降级使用，内核并存"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /boot/grup/grup.conf 执行命令，可以查看当前Linux运行那个内核；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8a8a460125131c0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看运行内核"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-35356da0c3c0bedb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="删除内核"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除以后查看当前运行内核是还是还是删除的在运行，内和放在内存和磁盘两个地方，删除的是磁盘里的。内核还在内存中，才重启后才会消失。（uname -r）</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> rpm &#123;-U|--upgrade&#125; [install-options]  PACKAGE_FILE ...</span><br><span class="line">安装有旧版程序包，则“升级”</span><br><span class="line">如果不存在旧版程序包，则“安装”</span><br><span class="line">升级会覆盖旧内核，生产中最好不使用升级，使用i安装。</span><br><span class="line"> rpm &#123;-F|--freshen&#125; [install-options]  PACKAGE_FILE ...</span><br><span class="line">安装有旧版程序包，则“升级”</span><br><span class="line">如果不存在旧版程序包，则不执行升级操作</span><br><span class="line">--force-----强制安装，只能在安装升级时候用，卸载时不能使用。</span><br><span class="line">rpm -e kernel --nodeps(不检查相关性 忽略依赖关系 不检查依赖性关系)----卸载内核</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--nosignature:不检查来源合法性</span><br><span class="line">--nodigest:不检查包完整性</span><br><span class="line">-noscriptts:不执行程序脚本</span><br><span class="line">%pre:安装前脚本-----nopre</span><br><span class="line">%post:安装后脚本----nopst</span><br><span class="line">%preun:卸载前脚本---nopreun</span><br><span class="line">%postun: 卸载猴脚本---nopostun</span><br></pre></td></tr></table></figure>
<ul>
<li>（1）不要对内核做升级操作：Linux支持多内核版本并存，因此，可以对其直接安装新版本内核。</li>
<li><p>（2）如果源程序包的配置文件安装后增被修改，升级时，新版本的提供的同一个配置文件并不会直接覆盖老版本的配置文件，而把新版本的文件重命名（FILENAME.RPMNEW）后保留。</p>
</li>
<li><p>包查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rpm&#123;-p| --query&#125;[select-options][query-option]</span><br><span class="line">rpm &#123; - p |——查询&#125;[选项][查询选项]</span><br><span class="line">rpm -p 【包名】</span><br><span class="line">[select-options]</span><br><span class="line">-a；所有包  ----加上管道grep可以模糊搜索</span><br></pre></td></tr></table></figure>
</li>
<li><p>-f:查看指定的文件有那个程序包安生成，来自哪个安装包。</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-55451353f6e88c55.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="用rm删除后可以用rpm -pf查询到文件生成的安装包"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7bab44d450ffd130.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="磁盘上是否每一个文件都来自安装包"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">不是每一个文件都来自安装包。</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-p rpmfile；针对尚未安装的程序包文件做查询操作</span><br><span class="line"></span><br><span class="line">有那个包所提供</span><br><span class="line">--whatprovides CAPABILITY;查询指定的CAPABILITY背那个包所依赖</span><br><span class="line">--provides:列出指定的程序包所提供的CAPABILITY[性能、能力]</span><br><span class="line">-R：查看指定的程序包所依赖的CAPABILITY</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-683fbc6baf746577.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="指定的能力所依赖的包、包具有的能力、指定的包所依赖的能力"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8eab7888c5457634.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="bash所依赖的库"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rmp2cpio（rpm to cpio） 包文件|cpio -itv 预览包内文件</span><br><span class="line">rpm2cpio (rpm to cpio) 包文件|cpio -id &quot;*.conf&quot; 释放包内文件</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a35b858177b839fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="rpm2copi命令预览、解包、解压缩进行安装、需注意文件元数据(权限之类)"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">【query-options】</span><br><span class="line">--changelog:查寻rpm包的changelog[变更日志，版本历史]</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-cc7de4e0f594b89b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="bash包更新历史查询"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">没有安装tree包,但可以查询tree安装列表，</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2b34e1def2697869.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="两种查看tree安装包列表"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-c:查询程序的配置文件</span><br><span class="line">-d:查询程序的文档</span><br><span class="line">-i:information</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-cd0e67cffde0d4c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查询文件列表信息"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-l:查询指定的程序安装后生成的所有文件</span><br><span class="line">--scripts:程序包自带的脚本</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7cf63c7a6ab4132f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查询包相关的脚本"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-qi packege, -qf file, -qc package, -ql package , -qd package</span><br><span class="line"></span><br><span class="line">-qpi package_file , -qpl package_file</span><br><span class="line">-qa</span><br><span class="line">包卸载：</span><br><span class="line">rpm &#123;-e| --erase&#125;[--allmatches][--nodeps][--noscripts][--notriggers][--test]package_name..</span><br><span class="line"></span><br><span class="line">rpm &#123; - e |——消除&#125;[——allmatches][——nodeps][——noscript][——被重置为notrigger][——测试]package_name . .</span><br><span class="line"></span><br><span class="line">包效验（查看属性变化）</span><br><span class="line">rpm &#123;-V|--verify&#125; [select-options] [verify-options]</span><br><span class="line">S file Size differs</span><br><span class="line">M Mode differs (includes permissions and file type)</span><br><span class="line">5 digest (formerly MD5 sum) differs</span><br><span class="line">D Device major/minor number mismatch</span><br><span class="line">L readLink(2) path mismatch</span><br><span class="line">U User ownership differs</span><br><span class="line">G Group ownership differs</span><br><span class="line">T mTime differs</span><br><span class="line">P capabilities differ</span><br><span class="line">rpm &#123; - v |——验证&#125;[选项][verify-options]</span><br><span class="line">年代文件大小不同</span><br><span class="line">M模式不同(包括权限和文件类型)</span><br><span class="line">5摘要(前MD5和)不同</span><br><span class="line">D设备/小数字不匹配</span><br><span class="line">L指向(2)路径不匹配</span><br><span class="line">U用户拥有不同</span><br><span class="line">G组所有权不同</span><br><span class="line">T mTime不同</span><br><span class="line">P能力不同</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-85566ff6f435894f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="定期查看指定文件变化"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">也可以查看所有文件属性变化，(-va）命令</span><br></pre></td></tr></table></figure></p>
<ul>
<li>安装软件包效验<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">包来源合法性验证及完整性验证</span><br><span class="line">完整性验证：SHA256</span><br><span class="line">来晕啊合法性验证：RSA</span><br><span class="line">公钥加密</span><br><span class="line">对称加密：加密,解密使用同一个秘钥</span><br><span class="line">非对称加密：密钥是成对儿的</span><br><span class="line">pablic key:公钥，公开所有人</span><br><span class="line">secret key:私钥，不能公开</span><br><span class="line">导入所需要公钥</span><br><span class="line">rpm -k|checksig rpmfile 检查包的完整性和签名</span><br><span class="line">rpm--import /etc/pki/rpm-gpg/rpm-gpg-key-Centos-7</span><br><span class="line">Centos7发行版光盘提供：RPM-GPG-KEY-Centos7</span><br><span class="line">rpm -qa &quot;gpg -pubkey*&quot;</span><br><span class="line">查看是否是厂家出厂原安装包，-K</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8f316340d829ddcf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="缺少检查工具，md5 not ok"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ff6ead52ab5d2205.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="导入密钥，检测,md5 ok"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">卸载蜜钥，查询装好的蜜钥</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8d67079fe7a57641.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查询蜜钥、卸载"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-fa1307ca0d3c025f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="光盘与磁盘的蜜钥位置"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-72b2d979727ea272.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="消除报警，导入蜜钥"></p>
<ul>
<li><p>rpm数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">数据库重建：</span><br><span class="line">/var/lib/rpm</span><br><span class="line">rpm&#123;--initdb|--rebuilddb&#125;</span><br><span class="line">initdb:初始化</span><br><span class="line">如果事先不存在数据库，新建之</span><br><span class="line">否则，不执行任何操作</span><br><span class="line">rebuilddb；重建已安装的包头的数据库索引目录</span><br><span class="line">！数据库初始化及重建数据都为空，没有意义。</span><br></pre></td></tr></table></figure>
</li>
<li><p>3、库文件移动后的修复过程<br><img src="http://upload-images.jianshu.io/upload_images/6132998-f82fc91abebf98b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lib64，如ls、cat、bc、cp……通用lib64库，节约空间。不能随意移动库文件否则将无法运用外部命令"></p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-f9eeff69bca12e89.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="用mv命令移动库文件后，无法重新启动系统。centos6无法运用图形界面"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">不使用快照的情况下，修复移除lib64库文件导致系统无法启动故障，在VMware下的修复方法。</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-0599d6b0f985a32f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="重新启动客户机，用光盘进救援模式"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">客户机重新启动后，运行光盘，当进度条走动的瞬间按一次Esc键，进入选项界面。（只能按一次，不能重复）</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-bc94d398134e695b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择第三项"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-c90d71e50ec42636.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择第三项，救援模式"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-dc70351d77e096b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择语言，默认即可"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-231a20153ad44f3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="不需要配置网络，选择NO"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-461c3e1c73333564.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="继续 只读 忽略 高级"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-81cc7f009ec8c90e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="初始安装系统时挂载点为根、救援模式时挂载点为/mnt/sysimares."></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-b298523447631eab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="进行下一步，回车得到一个shell，打开字符界面，更改根的位置。当前根位置为/mnt/sysimages,将其改为/，需在字符界面下执行命令 #chroot /mnt/sysmages."></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-9e94ce46a9f2a9cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="您的系统安装在/mn/sysimage目录下"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-03656c0411a560b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="开shell,进入字符界面"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-0939d91a8d3a9ec5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="输入#pwd命令显示当前为“/”，“/”为伪根、真正的根为/mnt/sysimage/。将lib64库文件移动还原，执行命令#chroot /mnt/sysimages可以切根“/”。"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-66f411b75f9d8f56.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="将库文件还原到lib64下，输入exit 退出"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1da5e541f9d4d9e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="重启，复原。"></p>
<ul>
<li><p>centos7移动lib64库文件，并进行修复。（类似centos6操作）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、重新启动客户机</span><br><span class="line">2、光盘引导进入</span><br><span class="line">3、按ESC键进入</span><br><span class="line">4、选择第三项，检测排错</span><br><span class="line">5、选择第二项，进入救援模式</span><br><span class="line">6、选择1回车</span><br><span class="line">7、c继续</span><br><span class="line">8、回车开启shell</span><br><span class="line">9、不能切根，移动回复lib64库文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>4、卸载内核后，Linux没有启动菜单项，系统无法启动。修复过程；</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-fc7881c0292ee63f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="没有Linux启动项"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">进入救援模式</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2db0f7a041d04faa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="挂在光盘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-838ced63e8a8c7c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="安装内核"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6dd96691fcee129b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="切换到根"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-d88abadd1e7a7f52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="强行安装内核"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6feec0affdf1f56d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="xx"></p>
]]></content>
      
        
        <tags>
            
            <tag> rpm </tag>
            
            <tag> lib64库文件，内核修复 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[修复MBR分区]]></title>
      <url>/2018/01/08/%E4%BF%AE%E6%94%B9MBR%E5%88%86%E5%8C%BA/</url>
      <content type="html"><![CDATA[<pre><code>1、准备工作将/dev/sda磁盘的MBR分区备份到、root目录下mbr文件   中，备份centos6整个虚拟机；
[root@centos6 ~]# dd if=/dev/sda of=mbr bs=1 count=512;
[root@centos6 ~]# hexdump -C -n 512 /dev/sda
[root@centos6 ~]# hexdump -C -n 512 mbr
2、拷贝完成后查看mbr中内容是否齐全；
3、清除/dev/sda、磁盘的MBR分区512字节；
[root@centos6 ~]# dd if=/dev/zero of=/dev/sda bs=1 count=512
[root@centos6 ~]# hexdump -C -n 512 /dev/sda
4、查看/dev/sda磁盘512字节有无变化；
5、重新启动虚拟机，看是否能启用：
[root@centos6 ~]# reboot
6、救援模式无法修复；
7、无法修复后，启用备份文件夹中的centos6;
8、成功启动centos6后，查看磁盘分布：
[root@centos6 ~]# lsblk
[root@centos6 ~]# ls /dev/sd*
[root@centos6 ~]# blkid
[root@centos6 ~]# cat /proc/partitions
9、从破损的虚拟机上找到破损的磁盘路径及文件；
# 查找时间上最近的虚拟磁盘文件；
10、将破损的虚拟机磁盘挂载到已开启centos6上;
# 添加硬盘、选择现有虚拟磁盘选项、浏览、挂载；
11、重新启动centos6；
12、找到破损磁盘名称及centos6磁盘名称；
13、查看centos6磁盘和破损磁盘分区MBR；
[root@centos6 ~]# lsblk
[root@centos6 ~]# blkid
14、用centos6磁盘来修复破损的磁盘；
[root@centos6 ~]# dd if=/dev/sda of=/dev/sdb bs=1 count=512
15、关闭centos6，卸载修复的磁盘；
[root@centos6 ~]# init 0
16、开启已修复的centos6，看是否能够正常运行；
17、移除复制备份的centos6；
18、修复完成；
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/6132998-b98f6d3db9bc80d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Centos6"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-dcad0d2fb69be177.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="将/dev/sda的MBR分区备份到mbr文件中"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4f0c7fa194a185a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="破坏/dev/sda"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-76112f24595a7a9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看MPR分区二进制文件"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-c0d79cca6a561f68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看磁盘状态"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-754a12716017e3c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="
![启用复制备份的Centos6](http://upload-images.jianshu.io/upload_images/6132998-b07c031fbd698a9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1f67ca56c781a0d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看磁盘状态及二进制mpr文件"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-868a3fd44fc382bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加破坏的虚拟机磁盘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-f767b782448f32a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="浏览选择破损的虚拟机光盘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2a43b82170e2fe04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择最近时间最大的虚拟机光盘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4ea526028a7179ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="没有显示破坏的虚拟机磁盘重新启动虚拟机"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8bef0a4442cb195b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="重启Centos6"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2693403153d0694f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看磁盘分区"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-d2ea7d995abc4a98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="修复破损的虚拟机磁盘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2ae1943f55e29f64.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="关闭centos6"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-5f5f3083627220f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="修复完成后，正常启动"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1767fe513f9ef2c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="结构图"></p>
<p>######MBR<br>    MBR<br>    0 磁道0 扇区：512bytes<br>    446bytes: boot loader<br>    64bytes ：分区表<br>    16bytes:  标识一个分区<br>    2bytes: 55AA</p>
<pre><code>破坏boot loader引导启动程序；
[root@centos6 ~]# dd if=/dev/zero of=/dev/sda bs=1 count=446
[root@centos6 ~]# dd if=mbr of=/dev/sda bs=1 count=446
破坏分区表及修复；
[root@centos6 ~]# dd if=/dev/zero of=/dev/sda bs=1 count=64 skip=446 seek=446
[root@centos6 ~]# dd if=mbr of=/dev/sda bs=1 count=64 skip=446 seek=446
破坏尾标55AA及修复；
[root@centos6 ~]# dd if=/dev/zero of=/dev/sda bs=1 chount=2 skip=510 seek=510
[root@centos6 ~]# dd if=mbr of=/dev/sda bs=1 count=2 skip=510 seek=510
</code></pre>]]></content>
      
        
        <tags>
            
            <tag> 修复MBR分区，故障处理 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Centos6,7修改密码]]></title>
      <url>/2018/01/08/Centos6%EF%BC%8C7%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/</url>
      <content type="html"><![CDATA[<p><strong>更改roor管理员UID为非零时，centos6、centos7无法正常启动。重启centos6、centos7时系统运行不一样。</strong></p>
<p><strong>一、Centos6</strong></p>
<p>1、centos6用户root地址更改为2000，ctrl+x/y进行保存。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7c130da7c17a569b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>2、更改root用户（UID)地址为2000，进行保存。在SecureCRT上从新开启centos6端口，无法连接centos6。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e33b20b8ee16b228.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>3、在VMwere上切换centos6新端口时，用户无法登入。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-c59fc3be995db516.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>4、用户无法登入与链接，系统处于故障状态。重启VMwere上的centos6→快速点击A键，进入编辑界面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-047c7100cf257e07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>5、输入命令init=/bin/bash回车。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-02bafa043649bd8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>6、输入命令mount -o remount,rw /  回车。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e2843699c403585f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>7、输入命令nano /etc/passwd，更改root地址UID为0，ctrl+x/y进行保存。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1996b32850346b7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-b3f71a61489de884.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>8、重新启动centos6.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ebdc9c58dbfcb8c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><strong>二、Centos7</strong></p>
<p>1、centos7用户root地址更改为2000，ctrl+x/y进行保存。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-05c1adbbc1f24212.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>2、root用户无法登，系统处于故障状态。重启VMwere上的centos7→快速点击E键，进入编辑界面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-5059bea0bd2a2c3d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>3、输入命令init=/bin/bash、按ctrl+x键进行下一步。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-79eb6e3072e39c19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>4、输入命令mount -o remount,rw /  回车。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1b18a084fb8502fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>5、输入命令nano /etc/passwd。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-f786db0f75eca9d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>6、更改root地址UID为0，ctrl+x/y进行保存。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-5b86ad56ca0311ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>7、重新启动centos7。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-709ee43b30f30585.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>Centos6重新启动成功,修复完成。</p>
]]></content>
      
        
        <tags>
            
            <tag> centos6 </tag>
            
            <tag> 7修改密码，故障修复 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[vim编辑器]]></title>
      <url>/2018/01/08/vim%E7%BC%96%E8%BE%91%E5%99%A8/</url>
      <content type="html"><![CDATA[<h4 id="vim的三种主要模式；"><a href="#vim的三种主要模式；" class="headerlink" title="vim的三种主要模式；"></a>vim的三种主要模式；</h4><p>命令模式、插入模式、扩展模式</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6871e6d74f94b805.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><strong>1、终端输入</strong> →  <strong>命令模式：</strong></p>
<p>vim /option/… 进入命令模式，光标默认行首。</p>
<p>vim +n /option/…进入命令模式，光标锁定第n行、行首。</p>
<p>vim +/^… /option/…进入命令模式，光标锁定已选定的第一个字符为行首。</p>
<p>vim + /option/…进入命令模式，光标锁定段尾行的第一个字符为行首。</p>
<p><strong>2、命令模式  </strong>→  <strong>插入模式：</strong></p>
<p>i：进入插入模式，光标位置，进行编辑。</p>
<p>a：进入插入模式，光标后一位，进行编辑。</p>
<p>o：进入插入模式，在光标位置下，添加一个新行。</p>
<p>I：进入插入模式，在光标所在的行首输入。</p>
<p>A：进入插入模式，在光标所在的行尾输入。</p>
<p>O：进入插入模式，在光标上一行，行首输入。</p>
<p>Esc键—–退出插入模式—–进入命令模式。</p>
<p><strong>3.1、命令模式 </strong> → <strong> 扩展模式：</strong></p>
<p>Shfit 加：键 …..进入扩展模式   ；</p>
<p>Esc、Enter键——退出扩展模式；</p>
<p><strong>3.2、终端输入</strong>→<strong>扩展模式:</strong></p>
<p>ex  /option/ :进入扩展模式</p>
<p><strong>3.3、扩展模式：</strong></p>
<p>：r————–在扩展模式下将读到文件内容输入到当前文件中。</p>
<p>：w————-在扩展模式下将当前文件内容写入另一个文件中。</p>
<p>：！————在扩展模式下输入！（command）回车，显示命令执行结果，再回车回到命令模式                        界面。</p>
<p>：r！———–在扩展模式下输入r！（command）回车，将命令内容读入到当前文件中。</p>
<p><strong>4、退出vim:</strong></p>
<p>：q ————-在没有进行修改操作时，进入扩展模式输入q退出。</p>
<p>：q! ————在操作时进行了输写修改，不想保存时进入扩展模式输入q!强行退出。</p>
<p>：wq ———–保存退出。</p>
<p>：wq!———–强制保存退出。</p>
<p>：x —————保存退出。</p>
<p>：ZZ————–在命令模式下，保存退出。</p>
<p>：ZQ————–在命令模式下，不保存退出。</p>
<h4 id="5、移动光标"><a href="#5、移动光标" class="headerlink" title="5、移动光标"></a>5、移动光标</h4><p>命令模式下移动光标；（只能在命令模式下移动光标）</p>
<p>← <strong>h 、</strong>↓ <strong>j、</strong> ↑<strong>k、</strong> →<strong> l    ：</strong>光标移动  左、下、上、右   </p>
<p>#h、#j、#k、#l、(#为数字)——执行#次命令（h、j、k、l）、移动#个字符。</p>
<p>w———-跳至下一个单词词首·。</p>
<p>W———-跳至下一个空格后单词词首。</p>
<p>b————跳至前一个单词词首.</p>
<p>B————跳至前第二个空格后词首。</p>
<p>H————跳至页首</p>
<p>M————跳至页中</p>
<p>L———— 跳至页尾</p>
<p>gg———–跳至文件首部，行首。</p>
<p>G————跳至文件尾部，行首。</p>
<p>：#———-跳至#行。</p>
<p>^————–跳至行首的第一个非空白符。</p>
<p>0（数字）–跳至行首。</p>
<p>$————–跳至行尾。</p>
<p>#G————跳至#指定行首。</p>
<p>1G、gg—–跳至第一行行首。</p>
<p>句间移动；</p>
<p>（————-跳至上一句。</p>
<p>）————-跳至下一句。</p>
<p>段落间移动；</p>
<p>{ ————-跳至上一段。</p>
<p>} ————-跳至下一段。</p>
<p>翻屏操作；</p>
<p>ctrl+B——–向首部翻屏</p>
<p>ctrl+F——–向尾部翻屏</p>
<p>ctrl+U——–向首部翻半屏</p>
<p>ctrl+D——–向尾部翻半屏</p>
<p><strong>6、命令界面操作，修改、删除、复制；</strong></p>
<p>x—————删除当前光标字符；</p>
<p>xp————-交换当前所在的字符与光标后面的字符；如：root、orot</p>
<p>~————–转换大小写；</p>
<p>J————–删除当前行的换行符；</p>
<p>r—————替换当前光标所在位置的字符；（输入的字符替换原有的字符）</p>
<p>R————–模式替换（REPLACE）</p>
<p>d($、0、^、w、b)—–删除</p>
<p>y($、0、^、w、b)——复制</p>
<p>c($、0、^、w、b)——修改</p>
<p>p——————————粘贴</p>
<p><strong>7、扩展模式，地址定界、查找、替换</strong></p>
<p>地址定界：（startpos,endpos）</p>
<h1 id="：—————————–第-行。"><a href="#：—————————–第-行。" class="headerlink" title="：—————————–第#行。"></a>：—————————–第#行。</h1><p>#，#：————————- 从左侧第#行到右侧第#行表示的行数。</p>
<p>#,+#：————————–从左侧第#行起，到加上右侧数字的行数。</p>
<p>.：——————————–当前行。</p>
<p>$：——————————-最后一行。</p>
<p>%：——————————全文，相当于1，$</p>
<p>/pat1/,/pat2/：—————–从第一次被/pat1/模式匹配到的行开始，一直到第一次被/pat2/匹配到的行结果。</p>
<p>查找  ：</p>
<p>/：（PATHERN）———–从当前光标处向文件尾部查找。</p>
<p>?：（PATHERN）———-从当前光标处向文件首部查找。</p>
<p>n、N —————————–辅助使用</p>
<p>查找并替换；</p>
<p>s：——————————–在扩展模式下完成查找替换操作。</p>
<pre><code>（s/查找模式/要替换成的内容/修饰符）
</code></pre><p>修饰符：</p>
<p>i：———————————忽略大小写</p>
<p>g:———————————–全局替换</p>
<p>多文件模式；</p>
<p>next：—————————–切换到下一个文件。</p>
<p>provious：———————–切换到上一个文件。</p>
<p>last：——————————切换到最后一个文件。</p>
<p>first：——————————切换到第一个文件。</p>
<p>wqall：—————————-保存所有文件。</p>
<p><strong>8、多窗口模式</strong></p>
<p>多文件：(vim -o a.txt b.txt……)</p>
<p>-o：——————————–水平分割</p>
<p>-O：——————————-垂直分割</p>
<p>在窗口间切换Ctrl+w,Arrow(上下左右箭头)</p>
<p>单文件；</p>
<p>Ctrl+w，s：———————水平分割</p>
<p>Ctrl+w，v：———————垂直分割</p>
<p>窗口属性定义；</p>
<p>set nu ：————————-显示行号</p>
<p>set nonu：———————–取消显示行号</p>
<p>set ai：—————————启用自动缩进功能</p>
<p>set noai：———————– 取消自动缩进功能</p>
<p>set ic：—————————忽略字符的大小写</p>
<p>set noic：————————不忽略字符的大小写</p>
<p>set sm：————————–括号匹配</p>
<p>set nosm:————————–取消括号匹配</p>
]]></content>
      
        
        <tags>
            
            <tag> vim编辑器 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Centos6半自动化安装.md]]></title>
      <url>/2018/01/08/Centos6%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%89%E8%A3%85/</url>
      <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">安装kickstart包；</span><br><span class="line">启用kicstart生成应答文件（可以参考anaconda-ks.cfg）；</span><br><span class="line">准备http://172.16.0.1/centos/6网址,网络光盘；</span><br><span class="line">安装vsftpd服务，将kickstart生成的应答文件放置在ftp共享文件夹下；</span><br><span class="line">开启主机，网卡配置桥接模式；</span><br><span class="line">进入启动选项菜单，按ESC键，输入并调用应答文件；</span><br><span class="line"># linux ks=ftp://172.16.250.134/pub/centos6.cfg</span><br><span class="line">回车运行，开始安装系统；</span><br><span class="line">进入系统选项界面，并回车开启安装完成的系统；</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">安装kickstart 包；</span><br><span class="line">#yum -y install kickstart</span><br><span class="line">在图形界面下才支持打开；</span><br><span class="line">#system-config-start</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-a96c8470c494dcf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">网络安装；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-dd68689cc023a580.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以给grub设置密码，防止单用户修改密码；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-00debcc6c9a0dcbc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">磁盘分区；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-48e49e6602866a74.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">清除mpr,不清除的话，机器上有mbr，会停在那里不运行；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-80420ca418b23f5b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">网络，自动获取ip；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-54904ad82780789d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">验证方法，一般不动，基于SHA512验证；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-5da7941cca5c2cb9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">防火墙，默认选择禁用SElinux；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1a97754e93f74c64.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">选择界面，初始化选项；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ebec5b30927a5666.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">选择安装包组；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8106c9f4c3f30f66.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">选择并写入脚本路径；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-71dc7bc4b9d22ff8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">编写脚本创建用户，yum源，设置密码；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-0cd01774824f65cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">存盘退出（保存到家目录），并查看家目录确认一下；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-795d8aaf50cffd53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">检查脚本格式；#ksvalidator  ks.cfg</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6c41b26dc63aa77f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">将应答文件ks.cfg放到ftp上；</span><br><span class="line">将ks.cfg拷贝到/var/ftp/pub/目录下；</span><br><span class="line">检查是否安装ftp服务；</span><br><span class="line">#yum info vsftpd</span><br><span class="line">#rpm ql vsftpd</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1bcb2f8e7960677b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">安装vsftp服务；</span><br><span class="line">#yum install vsftpd</span><br><span class="line">将文件拷贝到ftp共享目录下(/var/ftp/pub)；</span><br><span class="line">#cp ks.cfg /var/ftp/pub/</span><br><span class="line">启用vsftpd服务；</span><br><span class="line">#service vsftpd start</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-dad77b25e20e3491.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看防火墙是否在关闭状态；</span><br><span class="line">#iptables -nvL</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4ff2fd83ccd3cd11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">关闭防火墙；</span><br><span class="line">#service iptables stop</span><br><span class="line">#service iptebles status</span><br><span class="line">#service vsftp status</span><br><span class="line">查看共享文件；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-98d771faef3275d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">应答文件安装完成；</span><br><span class="line">调用linux应答文件启动主机；</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-4f170db6874c1136.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">点击光盘引导；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-d75842ca9e80d15c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">点击ESC键；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-48b331f2c6c49bf0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入调用应答文件；</span><br><span class="line">#linux ks=ftp://192.168.239.141/pub/centos6.cfg</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-eae3e264a35af500.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">主机使用桥接模式；</span><br><span class="line">使用网络光盘；http://172.16.0.1/centos/6</span><br><span class="line">仅主机模式下无法获取地址；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-0f607581b7acf6e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安装系统，已完成；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-f5cbbc833729c93d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">三秒之内按任意键，选择启动系统选项菜单；</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-158043c240ac55bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">启动成功；</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> Centos6半自动化安装 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Centos6手动安装步骤]]></title>
      <url>/2018/01/08/Centos6%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4/</url>
      <content type="html"><![CDATA[<p>一、安装Centos6.9</p>
<p>1、选择磁盘空间足够大的本地磁盘，新建ISO、Centos6.9文件夹。将Centos映像光盘拷贝到ISO文件夹里，开启VMware 新建虚拟机。</p>
<p>选择经典 → 稍后安装操作系统 → 选择Linux操作系统 → Centos 64位 → 修改虚拟机名称 →更改虚拟机保存路径安装到指定的位置 → 设置磁盘大小200GB → 将虚拟磁盘存储为单个文件 → 点击完成→虚拟机创建完成;</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-58ad8aea61bb2e5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-909b0432265fe9b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-42c8ce93a0788bd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-8459601e2cba1334.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-07fb53e506f8ce2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>2、设置硬盘配置，安装操作系统。</p>
<p>（1）将硬件内存设置为2GB、处理器选择2个、网络适配器设置为仅主机模式、新建一个网络适配器设置为桥接模式。CD/DVD选择ISO文件夹中的Centos6文件、硬件设置完成。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-f44e4a1da252020d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>（2）开启虚拟机安装Centos6操作系统</p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-38b2250611f6065f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2b167e59b7b041f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-655e699ad4fd0389.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-7633180ca90ec6a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-023998b3bd9808ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-fa1ba8a57103525c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-5adc87529407683a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e5389a4518a48a21.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-ba20d0e5b3799df7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e608df4e68ae3f16.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-1d4bc35f12c08b7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-d48829e6d7b47d15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-e4f9000dcea6d6e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-13d5e7d520f4d405.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2ca63d015e15b6de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-3e2eb7a3eecc6afb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-c07167098ef22f6d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-2aadf799b37109d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/6132998-6342f7400d2c1db6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
]]></content>
      
        
        <tags>
            
            <tag> Centos6手动安装步骤 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Linux系统调优]]></title>
      <url>/2018/01/07/LINUX%E8%B0%83%E4%BC%98/</url>
      <content type="html"><![CDATA[<h3 id="linux系统调优"><a href="#linux系统调优" class="headerlink" title="linux系统调优"></a>linux系统调优</h3><hr>
<ul>
<li>进程调度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">os:</span><br><span class="line">硬件抽象，虚拟计算机</span><br><span class="line">system call---操作系统输出</span><br><span class="line">cpu：</span><br><span class="line">虚拟化，基于时序进行分段运行的，消耗时间片（time slice），</span><br><span class="line">某些进程优先级---打标签</span><br><span class="line">调度器：</span><br><span class="line">也是程序---内核中的进程调度子系统。</span><br><span class="line">调度器中的一种 CFS调度器</span><br><span class="line">调度器：Big O 算法</span><br><span class="line">O（1）从进程中选择一个进程所需要的时长时恒定的；调度进程，优先级。</span><br><span class="line">优先级分为两类：</span><br><span class="line">实时优先级--- 0-99</span><br><span class="line">静态优先级--- 100-139，用户可以手动指定nice值来调整优先级；</span><br><span class="line">Memory:内存</span><br><span class="line">虚拟地址空间</span><br><span class="line">PAE：</span><br><span class="line">32bits,4bits在32位的基础上加入4位变成现今的64G；</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cpu调度</span><br><span class="line">0-139</span><br><span class="line">实时优先级；1-99---数值越大优先级越高</span><br><span class="line">动态优先级；100-139--数字越小优先级越高</span><br><span class="line"></span><br><span class="line">linux里调度器有多个不同的调度器；对于同一个进程由优先级较高的调度器进行调度；</span><br><span class="line">用户空间；调度器为CFS完全公平调度</span><br><span class="line">实时进程；调度器为SCHED_FIFO【0-99】</span><br><span class="line"></span><br><span class="line">类别；</span><br><span class="line">实时优先级调度；</span><br><span class="line">SCHED_FIFO ---调度器为先进先出 【0-99】---调度内核级别</span><br><span class="line">SCHED_RR ---轮询调度---同一种级别的进程有轮询的方式进行调度；</span><br><span class="line">用户空间调度；</span><br><span class="line">SCHED_NORMAL,SCHED_OTHER 【100-139】---完全公平调度</span><br><span class="line"></span><br><span class="line">cpu调度进行更改；</span><br><span class="line">动态优先级调度，用户空间调度；</span><br><span class="line">SCHED_FIFO,</span><br><span class="line">nice,renice</span><br><span class="line">实时优先级调度更改；</span><br><span class="line">SCHED_FIFO</span><br><span class="line"># chrt -f [1-99] /path/to/program arguments</span><br><span class="line">SCHED_RR;real-time</span><br><span class="line"># chrt -r [1-99] /path/to/program arguments</span><br></pre></td></tr></table></figure>
<ul>
<li>cpu绑定</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">strace 跟踪进程</span><br><span class="line"></span><br><span class="line">绑定cpu;</span><br><span class="line"># cat /proc/cpuinfo ---查看cpu个数类型</span><br><span class="line"># ps axo psr，comm ---显示哪个程序运在哪个CPU上，</span><br><span class="line"># ps axo psr,comm,pid---显示运行的进程及pid</span><br><span class="line">绑定qpidi进程的cpu</span><br><span class="line"># taskset -p -c 3  11215</span><br><span class="line"># ps axo psr，comm</span><br><span class="line">也可以绑定两个cpu</span><br><span class="line"># taskset -p -c 3,4  11215</span><br><span class="line"># ps axo psr，comm</span><br><span class="line"></span><br><span class="line">中断和IRQ调节，将cpu隔离出来专门记录中断信息；</span><br><span class="line">查看中断文件每个CPU的中断数；</span><br><span class="line"># cat /proc/interrupts--- cpu的io中断号</span><br><span class="line"># ls /proc/irp/---中断文件       </span><br><span class="line"># ls /proc/interrupts/0/---查看中断文件的中的绑定cpu的文件；</span><br><span class="line"># cat /proc/irp/0/smp_affinity</span><br><span class="line">ffffffff,ffffffff----一般情况下默认绑定格式；</span><br><span class="line"></span><br><span class="line">定义中断由第一个cpu处理绑定；</span><br><span class="line"># echo 1 &gt;/proc/irp/32/smp_affinity---定义32号中断由第一个CPU来处理</span><br><span class="line"># cat  /proc/irp/32/smp_affinity</span><br><span class="line">1</span><br><span class="line">要想将所有的中断号绑定在1号CPU需要脚本来实现；</span><br></pre></td></tr></table></figure>
<p>numa—服务实现自动绑定CPU;略<br>numa,numactl,numad<br>nice renlce 查文档</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">隔离CPU编辑配置文件；</span><br><span class="line">/etc/grub.conf</span><br><span class="line">内容尾部kernel后添加Isolcpus=cpu namber,cpu nameber (注意写上cpu的号码，0，1，2，3)</span><br><span class="line">定义中断smp_affinity；</span><br><span class="line"># echo cpunamber,...&gt;/proc/irp/#编号/smp_affinity/</span><br><span class="line">中断中使用的CPU是处Isolcpus外的CPU；</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">建议使用的监控工具CPU utilinzation;</span><br><span class="line">htop,dstat,glances,sar，sysdig(需要自己编译安装)</span><br><span class="line"># sar -p ALL 1 显示一秒钟所有使用率cpu</span><br><span class="line"># iostat -c 1 ---显示cpu的使用率；查看io状态命令，也可以查看cpu</span><br><span class="line"># uptime ---可以查看cpu使用率，平均负载情况；</span><br><span class="line"># vmstat 1 ----查看 procs运行队列和阻塞队列长度</span><br><span class="line">使用strace命令追踪进程查看所阻塞的进程；</span><br><span class="line">上述命令都是从/proc,/sys目录下剪切出来的，可以查看源文件；</span><br></pre></td></tr></table></figure>
<ul>
<li>linux 内存使用架构；</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">linux所有共享库都在/lib64目录下；</span><br><span class="line">进程调用此目录下的代码；</span><br><span class="line">DMA:</span><br><span class="line">cpu跟外部设备IO设备进行交互的方式；</span><br><span class="line">poll:轮询，忙等待；</span><br><span class="line">中断:</span><br><span class="line">由DMA：自带芯片发送起请求到cpu</span><br><span class="line"></span><br><span class="line">与cup相关的工具；代码级时编译安装编写脚本；评估系统性能；</span><br><span class="line">systemtap,oprofile,valgrind</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">内存；</span><br><span class="line">1、大页面和透明大页面；</span><br><span class="line">内存时由块管理，即众所周知的页面，一个页面由4096字节。1MB内存等于256个页面。1GB内存等于256000个页面等等。CPU有内嵌的内存管理单元，这些的单元包含这些页面列表，每个页面都是用页面条目参考；</span><br><span class="line">让系统管理大量内存有两种方法；</span><br><span class="line">-增加内存管理单元中页表数；</span><br><span class="line">-增加页面大小；</span><br><span class="line"> 第一种方法很昂贵，因为现代处理器中的硬件内存管理单元只支持数百或者书签页表条目。另外适用于管理书签页面（MB内存）硬件和内存算法可能无法很好的管理数百万（甚至数十亿）页面。这会造成性能问题；但程序需要使用比内存管理单元支持的更多的页面，该系统同会退回到缓慢的给予软件的内存管理，从而造成整个系统缓慢运行。</span><br><span class="line"></span><br><span class="line"> 红帽企业版LINUX6采用第二种方法，即使用超大页面。</span><br><span class="line"> 简单说，超大页面是2MB和1GB大小的内存模块。2MB使用的页表可管理多GB内存，而1GB页是TB内存的最佳选择。</span><br><span class="line"></span><br><span class="line"> 超大页面必须引导时分配。他们也很难受懂管理，且经常需要更改代码以便可以有效使用。因此红帽企业版LInux也部署了透明超大页（THP）。THP是一个提取城，可自动创建，管理和使用超大页面的大多数方案；</span><br><span class="line"></span><br><span class="line"> 使用Valgtind简要描述内存使用；C编译成精通编写可以研究；</span><br><span class="line"></span><br><span class="line"> 其他工具；systemtap,oprofile，vagraind都需要写脚本，红帽官方有systemtap使用。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、编译内核参数；</span><br><span class="line">    内存调优，proc文件系统的、proc/sys/vm目录中</span><br><span class="line">    （1）内存调优；memory过量使用，有三种类型；</span><br><span class="line">    overcommit_memory:有三种参数，分别为0,1,2 ；</span><br><span class="line">    0---默认设置。内核执行启发式内存过量使用处理，方法是估算可用内存量，并拒绝明显的无效的请求。遗憾的是因为存是使用启发式而非准确算法进行部署，这个设置有时可能会赵成系统中的可用内存超载。</span><br><span class="line">    1---内核执行无内存过量使用处理，使用之歌设置会增大内存超载的可能性，但也可以增强大量使用内存任务的性能。</span><br><span class="line">    2---内存拒绝等于或者大于总可用swap大小及overcommit_ratio指定的物理RAM比例的内存请求。如果您希望减小内存过度使用的风险，这个设置就是最好的；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    2---模式中的overcommit_ratio为比例参数；</span><br><span class="line">    内存模式为，swap+RAM*overcommit_ratio磁盘使用大小；</span><br><span class="line">    已条有目的的话使用1模式，2模式将不在考虑范围；</span><br><span class="line"></span><br><span class="line">    配置文件；vim /etc/sysctl.conf当中尾部添加</span><br><span class="line">    vm.overcommit_memory = 1</span><br><span class="line">    保存以后使用sysctl -p命令执行；</span><br><span class="line">     (2)nr_hugepages大内存页；</span><br><span class="line">     规定在内存中配置的超大页数。默认为0。只有系统中有足够的连续可用页时方可分配（或者取消分配）超大页。为这个参数保留的页无法用于其他目的。安装文件</span><br><span class="line">     /usr/share/doc/kernel-doc-kernel_version/Documentation/vm/hugetlbpage.txt</span><br><span class="line"></span><br><span class="line">    查看大内存页使用情况；cat /proc/meminfo</span><br><span class="line">     AnonHugepages   110592 ---有内核自动使用维护的；透明匿名的大内存页；</span><br><span class="line">     Hugepages_Total 0   大内存页使用情况为没有使用</span><br><span class="line">     Hugepages_Free  0   </span><br><span class="line">     Hugepages_Rsvd  0</span><br><span class="line">     Hugepages_Surp  0</span><br><span class="line">     Hugepagesize    2048 大内存页的大小为两兆MB</span><br><span class="line"></span><br><span class="line">     配置大内存页；vim /etc/sysctl.conf当中尾部添加</span><br><span class="line">     vm.nr_hugepages = 10 ---添加10个内存页；</span><br><span class="line">     # sysctl -p ---运行一下</span><br><span class="line">     # cat /proc/meminfo ---查看内存页使用情况</span><br><span class="line"></span><br><span class="line">     也可以使用大内存页使用基于内存的文件系统；</span><br><span class="line">     将大内存页进行挂在文件系统实现；</span><br><span class="line">```     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 于容量相关的内核可调参数；</span><br></pre></td></tr></table></figure>
<p>位于参数proc文件系统中/proc/sys/kernel/目录中；<br>msgmax —消息队列；单个消息的大小。<br> -一字节为单规定消息队列中任意信息的最大允许大小。这个值一定不能超过该队列的大小（msgmnb）.默认值为65536字节；<br>msgmnb<br> -以字节为单位规定单一信息队列的最大值。默认为65536字节；<br>msgmni<br> -规定信息队列识别符的最大数量（以及队列的最大数量）。64位架构机器的默认值为1985；32位架机器的默认值为1736.</p>
<p>shmall —共享内存<br>  -字节位单位规定一次在该系统中可使用的共享内存总量。64位架构机器的默认值为4294967296；32位架构机器的默认值为268435456.<br>shmmax<br>  -以字节为单位规定内核可允许的最大共享内存片。64位架构机器的默认值为68719476736；32位架构机器的默认值为4294967295.注：单内核支持的值比这个值要多得多。<br>shmmni<br>  -规定系统范围内最大共享内存片段。在63位和32位架构机器中的默认值都是4096。<br>threads-max<br>  -规定一次内核使用的最大线程（任务）数。默认值与max_threads相同。使用的方程式是；<br>  max_threads=mempages / (8 * THREAD_SIZE / PAGE_SIZE)<br>  threads-max的最小值为20.</p>
<p>  shmmni * shmall =shmmax 多少片乘上片的大小等于总数大小；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">-与容量相关的文件系统可调参数；</span><br></pre></td></tr></table></figure></p>
<p>已下可调参数位于proc文件系统的/proc/sys/fs/目录中。<br>aio-max-nr<br> -规定在所有活动异步I/O上下文中可允许的最多事件数。默认值为65536。注：更改这个值不会预先分配或者重新定义内核数据结构的大小。</p>
<p> 使用nginx异步io时根据需求可以调大，消耗内存较大；</p>
<p> file-max<br>  -列出内核分配的文件数量的最大值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- Out-of-Memory kill 可调用参数；</span><br></pre></td></tr></table></figure>
<p>  -内存不足（OOM）指的时所有可用内存，包括swap空间都已经被分配的计算状态。默认情况下，这个状态可赵成系统panic,并停止如预期般工作。当/proc/sys/vm/panic_on_oom参数设定为0会让内核在出现OOM时调用oom_killer功能。通常oom_killer可杀死偷盗进程，并让系统正常运行；</p>
<p>  可在每一个进程中设定一下参数，提高您对被oom_killer功能杀死的进程进行的控制。它位于proc文件系统中/proc/pid/目录下，其中pid是进程id.</p>
<p>  oom_adj<br>   -定义-16到15之间的一个数值以便帮助决定某进程的oom_score。oom_score值越高，被oom_killer杀死的进程数就越多。将oom_adj值设定为-17则为该进程禁用oom_killer。</p>
<pre><code>？写脚本获取id号进行赋值，或者手动执行；

 当内存耗尽时系统将消耗最大的进程kill掉。
</code></pre> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 调整虚拟内存</span><br><span class="line">虚拟内存</span><br></pre></td></tr></table></figure>
<p>```</p>
]]></content>
      
        
        <tags>
            
            <tag> Linux系统调优 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[在github上搭建个人博客]]></title>
      <url>/2018/01/07/%E5%9C%A8github%E4%B8%8A%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<h1 id="在github上搭建-个人博客"><a href="#在github上搭建-个人博客" class="headerlink" title="在github上搭建 个人博客"></a>在github上搭建 个人博客</h1><ul>
<li>我的天啊  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我有一句吗卖批  不知当讲不当讲</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>There is a mmp in my hard , Do you have B number in your hard</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/user/bin/python</span><br><span class="line">print &quot;Hello, Your Mother is my Wife.&quot;;</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> github </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[xin]]></title>
      <url>/2018/01/07/xin/</url>
      <content type="html"><![CDATA[<p>这是一个测试页面</p>
]]></content>
      
        
        <tags>
            
            <tag> linux </tag>
            
            <tag> text </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2018/01/07/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[文章名]]></title>
      <url>/2017/05/19/blog0/</url>
      <content type="html"><![CDATA[<ul>
<li>进程调度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">os:</span><br><span class="line">硬件抽象，虚拟计算机</span><br><span class="line">system call---操作系统输出</span><br><span class="line">cpu：</span><br><span class="line">虚拟化，基于时序进行分段运行的，消耗时间片（time slice），</span><br><span class="line">某些进程优先级---打标签</span><br><span class="line">调度器：</span><br><span class="line">也是程序---内核中的进程调度子系统。</span><br><span class="line">调度器中的一种 CFS调度器</span><br><span class="line">调度器：Big O 算法</span><br><span class="line">O（1）从进程中选择一个进程所需要的时长时恒定的；调度进程，优先级。</span><br><span class="line">优先级分为两类：</span><br><span class="line">实时优先级--- 0-99</span><br><span class="line">静态优先级--- 100-139，用户可以手动指定nice值来调整优先级；</span><br><span class="line">Memory:内存</span><br><span class="line">虚拟地址空间</span><br><span class="line">PAE：</span><br><span class="line">32bits,4bits在32位的基础上加入4位变成现今的64G；</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cpu调度</span><br><span class="line">0-139</span><br><span class="line">实时优先级；1-99---数值越大优先级越高</span><br><span class="line">动态优先级；100-139--数字越小优先级越高</span><br><span class="line"></span><br><span class="line">linux里调度器有多个不同的调度器；对于同一个进程由优先级较高的调度器进行调度；</span><br><span class="line">用户空间；调度器为CFS完全公平调度</span><br><span class="line">实时进程；调度器为SCHED_FIFO【0-99】</span><br><span class="line"></span><br><span class="line">类别；</span><br><span class="line">实时优先级调度；</span><br><span class="line">SCHED_FIFO ---调度器为先进先出 【0-99】---调度内核级别</span><br><span class="line">SCHED_RR ---轮询调度---同一种级别的进程有轮询的方式进行调度；</span><br><span class="line">用户空间调度；</span><br><span class="line">SCHED_NORMAL,SCHED_OTHER 【100-139】---完全公平调度</span><br><span class="line"></span><br><span class="line">cpu调度进行更改；</span><br><span class="line">动态优先级调度，用户空间调度；</span><br><span class="line">SCHED_FIFO,</span><br><span class="line">nice,renice</span><br><span class="line">实时优先级调度更改；</span><br><span class="line">SCHED_FIFO</span><br><span class="line"># chrt -f [1-99] /path/to/program arguments</span><br><span class="line">SCHED_RR;real-time</span><br><span class="line"># chrt -r [1-99] /path/to/program arguments</span><br></pre></td></tr></table></figure>
<ul>
<li>cpu绑定</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">strace 跟踪进程</span><br><span class="line"></span><br><span class="line">绑定cpu;</span><br><span class="line"># cat /proc/cpuinfo ---查看cpu个数类型</span><br><span class="line"># ps axo psr，comm ---显示哪个程序运在哪个CPU上，</span><br><span class="line"># ps axo psr,comm,pid---显示运行的进程及pid</span><br><span class="line">绑定qpidi进程的cpu</span><br><span class="line"># taskset -p -c 3  11215</span><br><span class="line"># ps axo psr，comm</span><br><span class="line">也可以绑定两个cpu</span><br><span class="line"># taskset -p -c 3,4  11215</span><br><span class="line"># ps axo psr，comm</span><br><span class="line"></span><br><span class="line">中断和IRQ调节，将cpu隔离出来专门记录中断信息；</span><br><span class="line">查看中断文件每个CPU的中断数；</span><br><span class="line"># cat /proc/interrupts--- cpu的io中断号</span><br><span class="line"># ls /proc/irp/---中断文件       </span><br><span class="line"># ls /proc/interrupts/0/---查看中断文件的中的绑定cpu的文件；</span><br><span class="line"># cat /proc/irp/0/smp_affinity</span><br><span class="line">ffffffff,ffffffff----一般情况下默认绑定格式；</span><br><span class="line"></span><br><span class="line">定义中断由第一个cpu处理绑定；</span><br><span class="line"># echo 1 &gt;/proc/irp/32/smp_affinity---定义32号中断由第一个CPU来处理</span><br><span class="line"># cat  /proc/irp/32/smp_affinity</span><br><span class="line">1</span><br><span class="line">要想将所有的中断号绑定在1号CPU需要脚本来实现；</span><br></pre></td></tr></table></figure>
<p>numa—服务实现自动绑定CPU;略<br>numa,numactl,numad<br>nice renlce 查文档</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">隔离CPU编辑配置文件；</span><br><span class="line">/etc/grub.conf</span><br><span class="line">内容尾部kernel后添加Isolcpus=cpu namber,cpu nameber (注意写上cpu的号码，0，1，2，3)</span><br><span class="line">定义中断smp_affinity；</span><br><span class="line"># echo cpunamber,...&gt;/proc/irp/#编号/smp_affinity/</span><br><span class="line">中断中使用的CPU是处Isolcpus外的CPU；</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">建议使用的监控工具CPU utilinzation;</span><br><span class="line">htop,dstat,glances,sar，sysdig(需要自己编译安装)</span><br><span class="line"># sar -p ALL 1 显示一秒钟所有使用率cpu</span><br><span class="line"># iostat -c 1 ---显示cpu的使用率；查看io状态命令，也可以查看cpu</span><br><span class="line"># uptime ---可以查看cpu使用率，平均负载情况；</span><br><span class="line"># vmstat 1 ----查看 procs运行队列和阻塞队列长度</span><br><span class="line">使用strace命令追踪进程查看所阻塞的进程；</span><br><span class="line">上述命令都是从/proc,/sys目录下剪切出来的，可以查看源文件；</span><br></pre></td></tr></table></figure>
<ul>
<li>linux 内存使用架构；</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">linux所有共享库都在/lib64目录下；</span><br><span class="line">进程调用此目录下的代码；</span><br><span class="line">DMA:</span><br><span class="line">cpu跟外部设备IO设备进行交互的方式；</span><br><span class="line">poll:轮询，忙等待；</span><br><span class="line">中断:</span><br><span class="line">由DMA：自带芯片发送起请求到cpu</span><br><span class="line"></span><br><span class="line">与cup相关的工具；代码级时编译安装编写脚本；评估系统性能；</span><br><span class="line">systemtap,oprofile,valgrind</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">内存；</span><br><span class="line">1、大页面和透明大页面；</span><br><span class="line">内存时由块管理，即众所周知的页面，一个页面由4096字节。1MB内存等于256个页面。1GB内存等于256000个页面等等。CPU有内嵌的内存管理单元，这些的单元包含这些页面列表，每个页面都是用页面条目参考；</span><br><span class="line">让系统管理大量内存有两种方法；</span><br><span class="line">-增加内存管理单元中页表数；</span><br><span class="line">-增加页面大小；</span><br><span class="line"> 第一种方法很昂贵，因为现代处理器中的硬件内存管理单元只支持数百或者书签页表条目。另外适用于管理书签页面（MB内存）硬件和内存算法可能无法很好的管理数百万（甚至数十亿）页面。这会造成性能问题；但程序需要使用比内存管理单元支持的更多的页面，该系统同会退回到缓慢的给予软件的内存管理，从而造成整个系统缓慢运行。</span><br><span class="line"></span><br><span class="line"> 红帽企业版LINUX6采用第二种方法，即使用超大页面。</span><br><span class="line"> 简单说，超大页面是2MB和1GB大小的内存模块。2MB使用的页表可管理多GB内存，而1GB页是TB内存的最佳选择。</span><br><span class="line"></span><br><span class="line"> 超大页面必须引导时分配。他们也很难受懂管理，且经常需要更改代码以便可以有效使用。因此红帽企业版LInux也部署了透明超大页（THP）。THP是一个提取城，可自动创建，管理和使用超大页面的大多数方案；</span><br><span class="line"></span><br><span class="line"> 使用Valgtind简要描述内存使用；C编译成精通编写可以研究；</span><br><span class="line"></span><br><span class="line"> 其他工具；systemtap,oprofile，vagraind都需要写脚本，红帽官方有systemtap使用。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、编译内核参数；</span><br><span class="line">    内存调优，proc文件系统的、proc/sys/vm目录中</span><br><span class="line">    （1）内存调优；memory过量使用，有三种类型；</span><br><span class="line">    overcommit_memory:有三种参数，分别为0,1,2 ；</span><br><span class="line">    0---默认设置。内核执行启发式内存过量使用处理，方法是估算可用内存量，并拒绝明显的无效的请求。遗憾的是因为存是使用启发式而非准确算法进行部署，这个设置有时可能会赵成系统中的可用内存超载。</span><br><span class="line">    1---内核执行无内存过量使用处理，使用之歌设置会增大内存超载的可能性，但也可以增强大量使用内存任务的性能。</span><br><span class="line">    2---内存拒绝等于或者大于总可用swap大小及overcommit_ratio指定的物理RAM比例的内存请求。如果您希望减小内存过度使用的风险，这个设置就是最好的；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    2---模式中的overcommit_ratio为比例参数；</span><br><span class="line">    内存模式为，swap+RAM*overcommit_ratio磁盘使用大小；</span><br><span class="line">    已条有目的的话使用1模式，2模式将不在考虑范围；</span><br><span class="line"></span><br><span class="line">    配置文件；vim /etc/sysctl.conf当中尾部添加</span><br><span class="line">    vm.overcommit_memory = 1</span><br><span class="line">    保存以后使用sysctl -p命令执行；</span><br><span class="line">     (2)nr_hugepages大内存页；</span><br><span class="line">     规定在内存中配置的超大页数。默认为0。只有系统中有足够的连续可用页时方可分配（或者取消分配）超大页。为这个参数保留的页无法用于其他目的。安装文件</span><br><span class="line">     /usr/share/doc/kernel-doc-kernel_version/Documentation/vm/hugetlbpage.txt</span><br><span class="line"></span><br><span class="line">    查看大内存页使用情况；cat /proc/meminfo</span><br><span class="line">     AnonHugepages   110592 ---有内核自动使用维护的；透明匿名的大内存页；</span><br><span class="line">     Hugepages_Total 0   大内存页使用情况为没有使用</span><br><span class="line">     Hugepages_Free  0   </span><br><span class="line">     Hugepages_Rsvd  0</span><br><span class="line">     Hugepages_Surp  0</span><br><span class="line">     Hugepagesize    2048 大内存页的大小为两兆MB</span><br><span class="line"></span><br><span class="line">     配置大内存页；vim /etc/sysctl.conf当中尾部添加</span><br><span class="line">     vm.nr_hugepages = 10 ---添加10个内存页；</span><br><span class="line">     # sysctl -p ---运行一下</span><br><span class="line">     # cat /proc/meminfo ---查看内存页使用情况</span><br><span class="line"></span><br><span class="line">     也可以使用大内存页使用基于内存的文件系统；</span><br><span class="line">     将大内存页进行挂在文件系统实现；</span><br><span class="line">```     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 于容量相关的内核可调参数；</span><br></pre></td></tr></table></figure>
<p>位于参数proc文件系统中/proc/sys/kernel/目录中；<br>msgmax —消息队列；单个消息的大小。<br> -一字节为单规定消息队列中任意信息的最大允许大小。这个值一定不能超过该队列的大小（msgmnb）.默认值为65536字节；<br>msgmnb<br> -以字节为单位规定单一信息队列的最大值。默认为65536字节；<br>msgmni<br> -规定信息队列识别符的最大数量（以及队列的最大数量）。64位架构机器的默认值为1985；32位架机器的默认值为1736.</p>
<p>shmall —共享内存<br>  -字节位单位规定一次在该系统中可使用的共享内存总量。64位架构机器的默认值为4294967296；32位架构机器的默认值为268435456.<br>shmmax<br>  -以字节为单位规定内核可允许的最大共享内存片。64位架构机器的默认值为68719476736；32位架构机器的默认值为4294967295.注：单内核支持的值比这个值要多得多。<br>shmmni<br>  -规定系统范围内最大共享内存片段。在63位和32位架构机器中的默认值都是4096。<br>threads-max<br>  -规定一次内核使用的最大线程（任务）数。默认值与max_threads相同。使用的方程式是；<br>  max_threads=mempages / (8 * THREAD_SIZE / PAGE_SIZE)<br>  threads-max的最小值为20.</p>
<p>  shmmni * shmall =shmmax 多少片乘上片的大小等于总数大小；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">-与容量相关的文件系统可调参数；</span><br></pre></td></tr></table></figure></p>
<p>已下可调参数位于proc文件系统的/proc/sys/fs/目录中。<br>aio-max-nr<br> -规定在所有活动异步I/O上下文中可允许的最多事件数。默认值为65536。注：更改这个值不会预先分配或者重新定义内核数据结构的大小。</p>
<p> 使用nginx异步io时根据需求可以调大，消耗内存较大；</p>
<p> file-max<br>  -列出内核分配的文件数量的最大值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- Out-of-Memory kill 可调用参数；</span><br></pre></td></tr></table></figure>
<p>  -内存不足（OOM）指的时所有可用内存，包括swap空间都已经被分配的计算状态。默认情况下，这个状态可赵成系统panic,并停止如预期般工作。当/proc/sys/vm/panic_on_oom参数设定为0会让内核在出现OOM时调用oom_killer功能。通常oom_killer可杀死偷盗进程，并让系统正常运行；</p>
<p>  可在每一个进程中设定一下参数，提高您对被oom_killer功能杀死的进程进行的控制。它位于proc文件系统中/proc/pid/目录下，其中pid是进程id.</p>
<p>  oom_adj<br>   -定义-16到15之间的一个数值以便帮助决定某进程的oom_score。oom_score值越高，被oom_killer杀死的进程数就越多。将oom_adj值设定为-17则为该进程禁用oom_killer。</p>
<pre><code>？写脚本获取id号进行赋值，或者手动执行；

 当内存耗尽时系统将消耗最大的进程kill掉。
</code></pre> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 调整虚拟内存</span><br><span class="line">虚拟内存</span><br></pre></td></tr></table></figure>
<p>```</p>
]]></content>
      
        <categories>
            
            <category> Life </category>
            
        </categories>
        
        
        <tags>
            
            <tag> tag1 </tag>
            
            <tag> tag2 </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
